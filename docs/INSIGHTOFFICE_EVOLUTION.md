# Insight Business Suite é€²åŒ–æˆ¦ç•¥ â€” çµ±åˆä»•æ§˜æ›¸

> **å¯¾è±¡**: INSS / IOSH / IOSDï¼ˆInsight Business Suite å…¨è£½å“ï¼‰
> **æœ€çµ‚æ›´æ–°**: 2026-02-23
> **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆå®Œäº† â†’ å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

---

## 1. æ¦‚è¦ â€” 3 æœ¬æŸ±ã®é€²åŒ–

Insight Business Suite ã‚’ã€Œå˜ä½“ã® AI ã‚ªãƒ•ã‚£ã‚¹ãƒ„ãƒ¼ãƒ«ã€ã‹ã‚‰ã€Œä¼æ¥­ã®æ¥­å‹™åŸºç›¤ã€ã¸é€²åŒ–ã•ã›ã‚‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Insight Business Suite é€²åŒ–ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   ç¾åœ¨                        é€²åŒ–å¾Œ                                  â”‚
â”‚   â”€â”€â”€â”€                        â”€â”€â”€â”€                                   â”‚
â”‚   AI ã‚ªãƒ•ã‚£ã‚¹ãƒ„ãƒ¼ãƒ«   â”€â”€â†’     ä¼æ¥­ã®æ¥­å‹™åŸºç›¤                           â”‚
â”‚   (ãƒ­ãƒ¼ã‚«ãƒ«å®Œçµ)              (ã‚µãƒ¼ãƒãƒ¼é€£æº + AI + RPA)               â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Pillar 1     â”‚  â”‚ Pillar 2     â”‚  â”‚ Pillar 3                â”‚  â”‚
â”‚   â”‚              â”‚  â”‚              â”‚  â”‚                          â”‚  â”‚
â”‚   â”‚ ãƒ‡ãƒ¼ã‚¿åé›†   â”‚  â”‚ RPA Agent    â”‚  â”‚ ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†             â”‚  â”‚
â”‚   â”‚              â”‚  â”‚              â”‚  â”‚                          â”‚  â”‚
â”‚   â”‚ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ  â”‚  â”‚ Orchestrator â”‚  â”‚ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†           â”‚  â”‚
â”‚   â”‚ AI è»¢è¨˜      â”‚  â”‚ JOB é…ä¿¡     â”‚  â”‚ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é…å¸ƒ           â”‚  â”‚
â”‚   â”‚ AI æ¤œè¨¼      â”‚  â”‚ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ â”‚  â”‚ ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡         â”‚  â”‚
â”‚   â”‚ ã‚µãƒ¼ãƒãƒ¼é€ä¿¡  â”‚  â”‚ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© â”‚  â”‚ ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                 â”‚                        â”‚                â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                            â”‚                                         â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                   â”‚ Insight Businessâ”‚                                â”‚
â”‚                   â”‚ Suite (C# WPF) â”‚                                â”‚
â”‚                   â”‚ + Syncfusion   â”‚                                â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€²åŒ–ã®å…¨ä½“åƒ

| Pillar | æ¦‚è¦ | å¯¾è±¡è£½å“ | ã‚µãƒ¼ãƒãƒ¼ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | å„ªå…ˆåº¦ |
|:------:|------|---------|:-------:|:-----------:|:------:|
| **1** | ãƒ‡ãƒ¼ã‚¿åé›†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | IOSH | API å®Ÿè£…æ¸ˆã¿ | **æœªç€æ‰‹** | **æœ€å„ªå…ˆ** |
| **2** | RPA Agentï¼ˆInsightBot é€£æºï¼‰ | INSS/IOSH/IOSD | è¨­è¨ˆæ¸ˆã¿ | **æœªç€æ‰‹** | é«˜ |
| **3** | ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† | INSS/IOSH/IOSD | **æœªç€æ‰‹** | **æœªç€æ‰‹** | ä¸­ |

### è£½å“åˆ¥ã®é€²åŒ–ãƒãƒˆãƒªã‚¯ã‚¹

| æ©Ÿèƒ½ | IOSH | INSS | IOSD | å‚™è€ƒ |
|------|:----:|:----:|:----:|------|
| ãƒ‡ãƒ¼ã‚¿åé›†ï¼ˆPillar 1ï¼‰ | **â—‹** | â€” | â€” | IOSH å°‚ç”¨ |
| RPA Agentï¼ˆPillar 2ï¼‰ | â—‹ | â—‹ | â—‹ | å…¨è£½å“å…±é€š |
| ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ï¼ˆPillar 3ï¼‰ | â—‹ | â—‹ | â—‹ | å…¨è£½å“å…±é€š |
| ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ | â—‹ | â—‹ | â—‹ | BIZ+ |
| AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆï¼ˆæ—¢å­˜ï¼‰ | â—‹ | â—‹ | â—‹ | å®Ÿè£…æ¸ˆã¿ |
| Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ—¢å­˜ï¼‰ | â—‹ | â—‹ | â—‹ | å®Ÿè£…æ¸ˆã¿ |

---

## 2. Pillar 1: ãƒ‡ãƒ¼ã‚¿åé›†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆIOSH ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…ä»•æ§˜ï¼‰

### 2.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IOSH ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (C# WPF + Syncfusion)                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SfSpreadsheet (ãƒ¡ã‚¤ãƒ³)      â”‚  â”‚  å³ãƒ‘ãƒãƒ«                  â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚ é€šå¸¸ã‚·ãƒ¼ãƒˆ  â”‚DC ã‚·ãƒ¼ãƒˆ  â”‚ â”‚  â”‚  â”‚ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§       â”‚â”‚  â”‚
â”‚  â”‚  â”‚ (ç™½ã‚¿ãƒ–)   â”‚(é’ã‚¿ãƒ–)   â”‚ â”‚  â”‚  â”‚ â”œ æœˆæ¬¡å£²ä¸Šå ±å‘Š â°2/28 â”‚â”‚  â”‚
â”‚  â”‚  â”‚            â”‚          â”‚ â”‚  â”‚  â”‚ â”œ çµŒè²»ç²¾ç®—     âœ…é€ä¿¡æ¸ˆ â”‚â”‚  â”‚
â”‚  â”‚  â”‚            â”‚ â– å…¥åŠ›å¯  â”‚ â”‚  â”‚  â”‚ â”” äººå“¡è¨ˆç”»     ğŸ“ä¸‹æ›¸ã â”‚â”‚  â”‚
â”‚  â”‚  â”‚            â”‚ â– ãƒ­ãƒƒã‚¯  â”‚ â”‚  â”‚  â”‚                         â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚ æ“ä½œãƒ‘ãƒãƒ«              â”‚â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚ [AI è‡ªå‹•è»¢è¨˜]           â”‚â”‚  â”‚
â”‚  â”‚  â”‚ å…¥åŠ›é€²æ—ãƒãƒ¼           â”‚ â”‚  â”‚  â”‚ [AI æ¤œè¨¼]               â”‚â”‚  â”‚
â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 12/15 (80%)â”‚ â”‚  â”‚  â”‚ [ä¸‹æ›¸ãä¿å­˜] [é€ä¿¡]     â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚                         â”‚â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚  â”‚ æ®‹ã‚Š: AIè»¢è¨˜ 188å›/æœˆ   â”‚â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚ æ®‹ã‚Š: AIæ¤œè¨¼ 195å›/æœˆ   â”‚â”‚  â”‚
â”‚  â”‚  â”‚ æ¤œè¨¼çµæœãƒãƒ¼           â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â”‚  â”‚ âœ… 10  âš ï¸ 2  âŒ 0    â”‚ â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                         â”‚                                         â”‚
â”‚                    REST API (HTTPS)                                â”‚
â”‚                         â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ãƒ‡ãƒ¼ã‚¿åé›†ã‚µãƒ¼ãƒãƒ¼ (Hono + Supabase) â€” Port 9500            â”‚  â”‚
â”‚  â”‚  â€» API + DB + ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: å®Ÿè£…æ¸ˆã¿                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 IOSH å´ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ï¼ˆæ–°è¦è¿½åŠ åˆ†ï¼‰

```
InsightPerformanceManagement/
â”œâ”€â”€ DataCollection/                    â˜… æ–°è¦
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ DataCollectionApiClient.cs    # REST API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ TemplateManager.cs            # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ AiTransferService.cs          # AI è‡ªå‹•è»¢è¨˜ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ AiValidationService.cs        # AI æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ DataExtractor.cs              # Named Range â†’ JSON å¤‰æ›
â”‚   â”‚   â”œâ”€â”€ DraftManager.cs               # ä¸‹æ›¸ãã®ä¿å­˜ãƒ»å¾©å…ƒ
â”‚   â”‚   â””â”€â”€ SheetProtectionService.cs     # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã®ãƒ­ãƒƒã‚¯åˆ¶å¾¡
â”‚   â”œâ”€â”€ ViewModels/
â”‚   â”‚   â”œâ”€â”€ DataCollectionPanelViewModel.cs  # å³ãƒ‘ãƒãƒ«å…¨ä½“ã® VM
â”‚   â”‚   â”œâ”€â”€ TemplateListViewModel.cs         # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ AiTransferViewModel.cs           # AI è»¢è¨˜çµæœç”»é¢
â”‚   â”‚   â”œâ”€â”€ AiValidationViewModel.cs         # AI æ¤œè¨¼çµæœç”»é¢
â”‚   â”‚   â””â”€â”€ SubmissionViewModel.cs           # é€ä¿¡ç¢ºèªç”»é¢
â”‚   â”œâ”€â”€ Views/
â”‚   â”‚   â”œâ”€â”€ DataCollectionPanel.xaml          # å³ãƒ‘ãƒãƒ« UI
â”‚   â”‚   â”œâ”€â”€ TemplateListView.xaml             # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ AiTransferResultView.xaml         # AI è»¢è¨˜çµæœ
â”‚   â”‚   â”œâ”€â”€ AiValidationResultView.xaml       # AI æ¤œè¨¼çµæœ
â”‚   â”‚   â”œâ”€â”€ InputProgressBar.xaml             # å…¥åŠ›é€²æ—ãƒãƒ¼
â”‚   â”‚   â””â”€â”€ SubmissionDialog.xaml             # é€ä¿¡ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ DataCollectionTemplate.cs         # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‹ï¼ˆconfig/data-collection.ts æº–æ‹ ï¼‰
â”‚       â”œâ”€â”€ MappingDefinition.cs              # ãƒãƒƒãƒ”ãƒ³ã‚°å®šç¾©å‹
â”‚       â”œâ”€â”€ AiTransferResult.cs               # AI è»¢è¨˜çµæœå‹
â”‚       â”œâ”€â”€ AiValidationResult.cs             # AI æ¤œè¨¼çµæœå‹
â”‚       â”œâ”€â”€ SubmissionData.cs                 # é€ä¿¡ãƒ‡ãƒ¼ã‚¿å‹
â”‚       â””â”€â”€ DraftData.cs                      # ä¸‹æ›¸ããƒ‡ãƒ¼ã‚¿å‹
â”œâ”€â”€ Modules/
â”‚   â””â”€â”€ DataCollectionModule.cs           â˜… AddonManager ã¸ã®ç™»éŒ²
â””â”€â”€ ...
```

### 2.3 å®Ÿè£…è©³ç´° â€” å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 2.3.1 DataCollectionApiClient.cs

```csharp
/// <summary>
/// ãƒ‡ãƒ¼ã‚¿åé›†ã‚µãƒ¼ãƒãƒ¼ (Hono) ã¨ã® REST API é€šä¿¡ã€‚
/// ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©ã¯ insight-common/config/data-collection.ts ã«æº–æ‹ ã€‚
/// </summary>
public class DataCollectionApiClient
{
    private readonly HttpClient _httpClient;
    private readonly string _baseUrl;          // è¨­å®š: server_url
    private readonly string _licenseKey;       // X-Insight-License-Key ãƒ˜ãƒƒãƒ€ãƒ¼
    private readonly string? _userEmail;       // X-Insight-User-Email ãƒ˜ãƒƒãƒ€ãƒ¼ (Level 2+)

    // --- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç† ---
    Task<List<TemplateListItem>> GetTemplatesAsync(string? category = null);
    Task<(byte[] file, MappingDefinition mapping)> DownloadTemplateAsync(string templateId);
    Task<MappingDefinition> GetTemplateMappingAsync(string templateId);

    // --- ãƒ‡ãƒ¼ã‚¿é€ä¿¡ ---
    Task<SubmissionResult> SubmitDataAsync(string templateId, Dictionary<string, object> data, string? comment);
    Task<List<SubmissionStatus>> GetSubmissionStatusAsync(string? templateId = null);

    // --- ä¸‹æ›¸ã ---
    Task<DraftResult> SaveDraftAsync(string templateId, Dictionary<string, object> data);
    Task<Dictionary<string, object>?> LoadDraftAsync(string templateId);
    Task DeleteDraftAsync(string templateId);

    // --- AI ---
    Task<AiTransferResult> RequestAiTransferAsync(string templateId, byte[] sourceExcel, string? hints);
    Task<AiValidationResult> RequestAiValidationAsync(string templateId, Dictionary<string, object> data);
}
```

#### 2.3.2 ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º â€” SfSpreadsheet é€£æº

```csharp
/// <summary>
/// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ .xlsx ã‚’ SfSpreadsheet ã«è¡¨ç¤ºã—ã€
/// Named Ranges ã§å®šç¾©ã•ã‚ŒãŸå…¥åŠ›ã‚»ãƒ«ã®ã¿ç·¨é›†å¯èƒ½ã«ã™ã‚‹ã€‚
/// </summary>
public class TemplateManager
{
    /// <summary>
    /// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚·ãƒ¼ãƒˆã«è¿½åŠ è¡¨ç¤ºã™ã‚‹ã€‚
    /// é€šå¸¸ã® .iosh ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ãƒ¼ãƒˆã‚’ã€Œæ··åœ¨ã€ã•ã›ã‚‹ã€‚
    /// </summary>
    public async Task OpenTemplateAsync(
        SfSpreadsheet spreadsheet,
        string templateId,
        DataCollectionApiClient apiClient)
    {
        // 1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ + ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        var (xlsxBytes, mapping) = await apiClient.DownloadTemplateAsync(templateId);

        // 2. ExcelEngine ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿
        using var engine = new ExcelEngine();
        var workbook = engine.Excel.Workbooks.Open(new MemoryStream(xlsxBytes));

        // 3. ã‚·ãƒ¼ãƒˆã‚¿ãƒ–ã®è‰²ã‚’è¨­å®š (DEFAULT_SHEET_STYLE.tabColor)
        foreach (IWorksheet sheet in workbook.Worksheets)
        {
            sheet.TabColor = ExcelKnownColors.Blue;  // #2563EB
        }

        // 4. Sheet Protection â€” Named Ranges ã®ã‚»ãƒ«ã®ã¿ Unlock
        ApplySheetProtection(workbook, mapping);

        // 5. SfSpreadsheet ã«æ–°ã—ã„ã‚·ãƒ¼ãƒˆã¨ã—ã¦è¿½åŠ 
        spreadsheet.AddSheet(workbook);

        // 6. ä¸‹æ›¸ããŒã‚ã‚Œã°å€¤ã‚’å¾©å…ƒ
        var draftData = await apiClient.LoadDraftAsync(templateId);
        if (draftData != null)
            RestoreValues(workbook, mapping, draftData);
    }

    /// <summary>
    /// Named Ranges ã§å®šç¾©ã•ã‚ŒãŸã‚»ãƒ«ã®ã¿ Unlockã€ãã®ä»–ã¯ãƒ­ãƒƒã‚¯ã€‚
    /// </summary>
    private void ApplySheetProtection(IWorkbook workbook, MappingDefinition mapping)
    {
        foreach (IWorksheet sheet in workbook.Worksheets)
        {
            // å…¨ã‚»ãƒ«ã‚’ãƒ­ãƒƒã‚¯
            sheet.UsedRange.CellStyle.Locked = true;

            // Named Ranges ã®ã‚»ãƒ«ã®ã¿ Unlock + èƒŒæ™¯è‰²å¤‰æ›´
            foreach (var field in mapping.Fields)
            {
                var range = workbook.Names[field.NamedRange]?.RefersToRange;
                if (range != null)
                {
                    range.CellStyle.Locked = false;
                    range.CellStyle.Color = Color.White;  // #FFFFFF â€” å…¥åŠ›å¯èƒ½ã‚»ãƒ«
                    range.CellStyle.Borders[ExcelBordersIndex.EdgeBottom].Color
                        = Color.FromArgb(0x25, 0x63, 0xEB);  // é’ãƒœãƒ¼ãƒ€ãƒ¼
                }
            }

            // ã‚·ãƒ¼ãƒˆã‚’ä¿è­·ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã— â€” UI æ“ä½œã®åˆ¶é™ã®ã¿ï¼‰
            sheet.Protect("", ExcelSheetProtection.All);
        }
    }
}
```

#### 2.3.3 ãƒ‡ãƒ¼ã‚¿æŠ½å‡º â€” Named Range â†’ JSON

```csharp
/// <summary>
/// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã® Named Ranges ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€
/// ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ç”¨ã® JSON (Dictionary) ã«å¤‰æ›ã™ã‚‹ã€‚
/// </summary>
public class DataExtractor
{
    /// <summary>
    /// Named Ranges â†’ Dictionary&lt;string, object&gt; ã«å¤‰æ›ã€‚
    /// MappingField.type ã«å¾“ã£ã¦å‹å¤‰æ›ã™ã‚‹ã€‚
    /// </summary>
    public ExtractionResult ExtractData(IWorkbook workbook, MappingDefinition mapping)
    {
        var data = new Dictionary<string, object>();
        var errors = new List<ValidationError>();
        int filledCount = 0;
        int totalCount = mapping.Fields.Count;

        foreach (var field in mapping.Fields)
        {
            var namedRange = workbook.Names[field.NamedRange];
            if (namedRange == null)
            {
                errors.Add(new ValidationError(field.NamedRange, "Named Range not found"));
                continue;
            }

            var cell = namedRange.RefersToRange;
            var rawValue = cell.Value;

            // ç©ºãƒã‚§ãƒƒã‚¯
            if (string.IsNullOrWhiteSpace(rawValue?.ToString()))
            {
                if (field.Required)
                    errors.Add(new ValidationError(field.NamedRange,
                        $"{field.LabelJa} ã¯å¿…é ˆé …ç›®ã§ã™"));
                continue;
            }

            // å‹å¤‰æ›
            object typedValue = field.Type switch
            {
                "string"     => rawValue.ToString()!,
                "number"     => cell.Number,
                "integer"    => (int)cell.Number,
                "date"       => cell.DateTime.ToString("yyyy-MM-dd"),
                "boolean"    => cell.Boolean,
                "currency"   => Math.Round(cell.Number, field.DecimalPlaces ?? 0),
                "percentage" => cell.Number,
                _            => rawValue.ToString()!,
            };

            data[field.DbColumn] = typedValue;
            filledCount++;
        }

        return new ExtractionResult
        {
            Data = data,
            Valid = errors.Count == 0,
            Errors = errors,
            FilledCount = filledCount,
            TotalCount = totalCount,
        };
    }
}
```

#### 2.3.4 AI è‡ªå‹•è»¢è¨˜ãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œãƒ•ãƒ­ãƒ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å³ãƒ‘ãƒãƒ«ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ â†’ ã‚·ãƒ¼ãƒˆã«è¡¨ç¤º               â”‚
â”‚  2. ã€ŒAI è‡ªå‹•è»¢è¨˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯                           â”‚
â”‚  3. ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚° â†’ è»¢è¨˜å…ƒã® .xlsx ã‚’é¸æŠ            â”‚
â”‚  4. AI ãŒåˆ†æä¸­... (ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼)                          â”‚
â”‚  5. è»¢è¨˜çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢:                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰     â”‚ è»¢è¨˜å€¤        â”‚ ç¢ºä¿¡åº¦  â”‚ çŠ¶æ…‹  â”‚   â”‚
â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚     â”‚ å£²ä¸Šé«˜         â”‚ Â¥12,500,000  â”‚  0.95  â”‚ âœ…    â”‚   â”‚
â”‚     â”‚ å–¶æ¥­åˆ©ç›Š       â”‚ Â¥3,200,000   â”‚  0.92  â”‚ âœ…    â”‚   â”‚
â”‚     â”‚ å¾“æ¥­å“¡æ•°       â”‚ 150          â”‚  0.72  â”‚ âš ï¸    â”‚   â”‚ â† è¦ç¢ºèª
â”‚     â”‚ éƒ¨é–€ã‚³ãƒ¼ãƒ‰     â”‚ â€”            â”‚  â€”     â”‚ â­ï¸    â”‚   â”‚ â† ã‚¹ã‚­ãƒƒãƒ—
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  6. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¢ºèªãƒ»ä¿®æ­£ â†’ ã€Œé©ç”¨ã€ãƒœã‚¿ãƒ³                     â”‚
â”‚  7. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® Named Ranges ã«å€¤ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```csharp
/// <summary>
/// AI è‡ªå‹•è»¢è¨˜ã‚µãƒ¼ãƒ“ã‚¹ã€‚
/// è»¢è¨˜å…ƒ Excel ã®ãƒ‡ãƒ¼ã‚¿ã‚’ Claude API ã§ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒƒãƒãƒ³ã‚°ã—ã€
/// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® Named Ranges ã«è»¢è¨˜ã™ã‚‹ã€‚
/// </summary>
public class AiTransferService
{
    public async Task<AiTransferResult> TransferAsync(
        IWorkbook sourceWorkbook,    // è»¢è¨˜å…ƒ
        IWorkbook templateWorkbook,  // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
        MappingDefinition mapping,
        string? userHints = null)
    {
        // 1. è»¢è¨˜å…ƒ Excel ã®æ§‹é€ ã¨ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Š
        var sourceData = ExtractSourceData(sourceWorkbook);

        // 2. Claude API ã«ãƒãƒƒãƒãƒ³ã‚°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        //    - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® Named Ranges ä¸€è¦§ + å‹ + aiTransferHints
        //    - è»¢è¨˜å…ƒã®ã‚·ãƒ¼ãƒˆæ§‹é€  + ãƒ˜ãƒƒãƒ€ãƒ¼ + å€¤ã‚µãƒ³ãƒ—ãƒ«
        var result = await _claudeApi.RequestTransferAsync(sourceData, mapping, userHints);

        // 3. confidence >= 0.8 ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è‡ªå‹•è»¢è¨˜
        foreach (var field in result.Transferred.Where(f => f.Confidence >= 0.8))
        {
            var range = templateWorkbook.Names[field.NamedRange]?.RefersToRange;
            if (range != null)
                SetCellValue(range, field.Value, mapping.GetFieldType(field.NamedRange));
        }

        // 4. confidence < 0.8 ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯é»„è‰²ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆè¦ç¢ºèªï¼‰
        foreach (var field in result.RequiresReview)
        {
            var range = templateWorkbook.Names[field.NamedRange]?.RefersToRange;
            if (range != null)
                range.CellStyle.Color = Color.FromArgb(0xFF, 0xFB, 0xEB);  // é»„è‰²
        }

        return result;
    }
}
```

#### 2.3.5 AI æ¤œè¨¼ãƒ•ãƒ­ãƒ¼

```
æ¤œè¨¼ã® 2 æ®µéš:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹æ¤œè¨¼ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã€å³åº§ã«å®Ÿè¡Œï¼‰             â”‚
â”‚  â”œ å¿…é ˆãƒã‚§ãƒƒã‚¯ï¼ˆç©ºæ¬„ï¼‰                                       â”‚
â”‚  â”œ å‹ãƒã‚§ãƒƒã‚¯ï¼ˆæ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ–‡å­—åˆ—ãŒå…¥ã£ã¦ã„ãªã„ã‹ï¼‰        â”‚
â”‚  â”œ ç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼ˆmin/maxï¼‰                                    â”‚
â”‚  â”œ æ­£è¦è¡¨ç¾ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ç­‰ï¼‰                    â”‚
â”‚  â”” ã‚¯ãƒ­ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ï¼ˆåˆè¨ˆ = å†…è¨³ã®å’Œï¼‰                 â”‚
â”‚                                                               â”‚
â”‚  Phase 2: AI æ–‡è„ˆæ¤œè¨¼ï¼ˆClaude APIã€æ•°ç§’ã‹ã‹ã‚‹ï¼‰               â”‚
â”‚  â”œ å‰æœˆæ¯”ãƒ»å‰å¹´æ¯”ã®ç•°å¸¸å€¤æ¤œå‡º                                 â”‚
â”‚  â”œ æ¥­ç•Œç›¸å ´ã¨ã®ä¹–é›¢ãƒã‚§ãƒƒã‚¯                                    â”‚
â”‚  â”œ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é–“ã®æ„å‘³çš„æ•´åˆæ€§                                  â”‚
â”‚  â”” å…¨ä½“æ‰€è¦‹ãƒ»æ”¹å–„ææ¡ˆ                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¡¨ç¤º:
  ã‚»ãƒ«ã®èƒŒæ™¯è‰²ã§çµæœã‚’å¯è¦–åŒ–
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… ç·‘ (#F0FDF4) = OK                â”‚
  â”‚ âš ï¸ é»„ (#FFFBEB) = è­¦å‘Šï¼ˆé€ä¿¡å¯èƒ½ï¼‰   â”‚
  â”‚ âŒ èµ¤ (#FEF2F2) = ã‚¨ãƒ©ãƒ¼ï¼ˆé€ä¿¡ä¸å¯ï¼‰ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.3.6 é€ä¿¡ãƒ»ä¸‹æ›¸ããƒ•ãƒ­ãƒ¼

```
é€ä¿¡ãƒ•ãƒ­ãƒ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œé€ä¿¡ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯                         â”‚
â”‚  2. DataExtractor ãŒ Named Ranges ã‹ã‚‰å€¤ã‚’æŠ½å‡º                â”‚
â”‚  3. ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ                             â”‚
â”‚     - ã‚¨ãƒ©ãƒ¼ã‚ã‚Š â†’ é€ä¿¡ãƒ–ãƒ­ãƒƒã‚¯ã€ã‚¨ãƒ©ãƒ¼ã‚»ãƒ«ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹        â”‚
â”‚     - è­¦å‘Šã®ã¿ â†’ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã€Œè­¦å‘ŠãŒã‚ã‚Šã¾ã™ãŒé€ä¿¡ã—ã¾ã™ã‹ã€â”‚
â”‚  4. é€ä¿¡ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°                                        â”‚
â”‚     - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåã€å…¥åŠ›ã‚µãƒãƒªãƒ¼ã€AIæ¤œè¨¼çµæœã‚µãƒãƒªãƒ¼         â”‚
â”‚     - ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ï¼ˆä»»æ„ï¼‰                                   â”‚
â”‚  5. DataCollectionApiClient.SubmitDataAsync() ã‚’å‘¼ã³å‡ºã—      â”‚
â”‚  6. çµæœè¡¨ç¤º                                                  â”‚
â”‚     - accepted  â†’ ã€Œé€ä¿¡å®Œäº†ã€ç·‘ãƒˆãƒ¼ã‚¹ãƒˆ                      â”‚
â”‚     - pending_review â†’ ã€Œãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ã€é’ãƒˆãƒ¼ã‚¹ãƒˆ             â”‚
â”‚     - rejected â†’ ã€Œå·®ã—æˆ»ã—ã€èµ¤ãƒˆãƒ¼ã‚¹ãƒˆ + ç†ç”±è¡¨ç¤º            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸‹æ›¸ããƒ•ãƒ­ãƒ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªå‹•ä¿å­˜:                                                    â”‚
â”‚  - è¨­å®š: draft_auto_save_interval (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 60 ç§’)         â”‚
â”‚  - DispatcherTimer ã§å®šæœŸçš„ã« extract â†’ ä¿å­˜                  â”‚
â”‚                                                               â”‚
â”‚  ä¿å­˜å…ˆ (2 ç®‡æ‰€):                                             â”‚
â”‚  â‘  .iosh ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†… (ãƒ­ãƒ¼ã‚«ãƒ«)                    â”‚
â”‚  â‘¡ ãƒ‡ãƒ¼ã‚¿åé›†ã‚µãƒ¼ãƒãƒ¼ (ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚)                          â”‚
â”‚                                                               â”‚
â”‚  ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ:                                              â”‚
â”‚  - ã‚µãƒ¼ãƒãƒ¼ä¸é”æ™‚ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ä¿å­˜                            â”‚
â”‚  - æ¥ç¶šå›å¾©æ™‚ã«ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§è‡ªå‹•åŒæœŸ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.3.7 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚²ãƒ¼ãƒˆ

```csharp
// insight-common/config/data-collection.ts ã® DATA_COLLECTION_LIMITS ã«æº–æ‹ 

// æ©Ÿèƒ½åˆ©ç”¨å¯å¦ãƒã‚§ãƒƒã‚¯
if (!DataCollectionLimits.CanUseDataCollection(currentPlan))
{
    ShowUpgradeDialog("ãƒ‡ãƒ¼ã‚¿åé›†æ©Ÿèƒ½ã¯ BIZ / ENT ãƒ—ãƒ©ãƒ³ã§åˆ©ç”¨ã§ãã¾ã™");
    return;
}

// AI è»¢è¨˜ã®æœˆæ¬¡å›æ•°ãƒã‚§ãƒƒã‚¯
if (!DataCollectionLimits.CanUseAiTransfer(currentPlan, monthlyTransferUsage))
{
    ShowLimitDialog("AI è‡ªå‹•è»¢è¨˜ã®æœˆé–“åˆ©ç”¨å›æ•°ã«é”ã—ã¾ã—ãŸ");
    return;
}

// AI æ¤œè¨¼ã®æœˆæ¬¡å›æ•°ãƒã‚§ãƒƒã‚¯
if (!DataCollectionLimits.CanUseAiValidation(currentPlan, monthlyValidationUsage))
{
    ShowLimitDialog("AI æ¤œè¨¼ã®æœˆé–“åˆ©ç”¨å›æ•°ã«é”ã—ã¾ã—ãŸ");
    return;
}
```

| ãƒ—ãƒ©ãƒ³ | ãƒ‡ãƒ¼ã‚¿åé›† | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ•° | AI è»¢è¨˜/æœˆ | AI æ¤œè¨¼/æœˆ | ãƒ‡ãƒ¼ã‚¿ä¿æŒ |
|--------|:---------:|:------------:|:---------:|:---------:|:---------:|
| TRIAL  | âœ… | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ | 30æ—¥ |
| FREE   | âŒ | â€” | â€” | â€” | â€” |
| BIZ    | âœ… | 50 | 200 | 200 | 365æ—¥ |
| ENT    | âœ… | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ |

### 2.4 æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã¨ã®å¯¾å¿œè¡¨

| insight-common ã®ãƒªã‚½ãƒ¼ã‚¹ | IOSH å´ã§ä½¿ã†å ´é¢ |
|--------------------------|-----------------|
| `config/data-collection.ts` â€” å‹å®šç¾© | C# ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã®å®šç¾©å…ƒ |
| `config/data-collection.ts` â€” `DATA_COLLECTION_API` | REST API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |
| `config/data-collection.ts` â€” `DATA_COLLECTION_LIMITS` | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚²ãƒ¼ãƒˆåˆ¤å®š |
| `config/data-collection.ts` â€” `DEFAULT_SHEET_STYLE` | ã‚»ãƒ«è‰²ãƒ»ã‚¿ãƒ–è‰²ã®å®šæ•° |
| `config/data-collection.ts` â€” `DB_TABLES` | API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹ç†è§£ |
| `config/addon-modules.ts` â€” `DATA_COLLECTION_MODULE` | AddonManager ã¸ã®ç™»éŒ²ãƒ»I/O ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ |
| `config/products.ts` â€” `data_collection` feature | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚­ãƒ¼ |
| `templates/web-api-data-collection/` | ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰ |

---

## 3. Pillar 2: RPA Agentï¼ˆInsightBot Orchestrator é€£æºï¼‰

### 3.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  InsightBot (Orchestrator) â€” INBT BIZ/ENT                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ JOB ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼                                         â”‚   â”‚
â”‚  â”‚ â”œ JOB ä½œæˆãƒ»ç·¨é›†ï¼ˆAI ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ï¼‰                   â”‚   â”‚
â”‚  â”‚ â”œ Agent ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆç™»éŒ²ãƒ»çŠ¶æ…‹ãƒ»å®Ÿè¡Œä¸­ JOBï¼‰          â”‚   â”‚
â”‚  â”‚ â”œ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ï¼ˆcron ç›¸å½“ã®å®šæœŸå®Ÿè¡Œï¼‰                   â”‚   â”‚
â”‚  â”‚ â”” ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆBPO ãƒ‘ã‚¿ãƒ¼ãƒ³: è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«é †æ¬¡å‡¦ç†ï¼‰      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                    â”‚
â”‚                         WebSocket (Port 9400)                     â”‚
â”‚                              â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Insight Business Suite Agent ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (bot_agent)               â”‚
â”‚                              â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Agent A      â”‚  â”‚ Agent B      â”‚  â”‚ Agent C      â”‚           â”‚
â”‚  â”‚ IOSH çµŒç†PC  â”‚  â”‚ INSS å–¶æ¥­PC  â”‚  â”‚ IOSD æ³•å‹™PC  â”‚           â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚           â”‚
â”‚  â”‚ bot_agent    â”‚  â”‚ bot_agent    â”‚  â”‚ bot_agent    â”‚           â”‚
â”‚  â”‚ python_runtime  â”‚ python_runtime  â”‚ python_runtime           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 IOSH å´ã®å®Ÿè£…ï¼ˆbot_agent ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰

```
InsightPerformanceManagement/
â”œâ”€â”€ BotAgent/                          â˜… æ–°è¦
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ AgentConnectionService.cs     # WebSocket æ¥ç¶šç®¡ç†
â”‚   â”‚   â”œâ”€â”€ HeartbeatService.cs           # 30ç§’é–“éš”ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ JobExecutionService.cs        # JOB ã®å—ä¿¡ãƒ»å®Ÿè¡Œ
â”‚   â”‚   â”œâ”€â”€ WorkflowExecutionService.cs   # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®é †æ¬¡å®Ÿè¡Œ
â”‚   â”‚   â””â”€â”€ DocumentOperationService.cs   # open/close/save ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ“ä½œ
â”‚   â”œâ”€â”€ ViewModels/
â”‚   â”‚   â””â”€â”€ AgentStatusViewModel.cs       # æ¥ç¶šçŠ¶æ…‹ãƒ»å®Ÿè¡Œä¸­ JOB è¡¨ç¤º
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ AgentInfo.cs                  # config/orchestrator.ts æº–æ‹ 
â”‚       â”œâ”€â”€ JobDefinition.cs
â”‚       â”œâ”€â”€ WorkflowDefinition.cs
â”‚       â””â”€â”€ Messages.cs                   # WebSocket ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‹
```

#### 3.2.1 Agent æ¥ç¶šãƒ•ãƒ­ãƒ¼

```
èµ·å‹•æ™‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¨­å®šç”»é¢ã§ Orchestrator URL ã‚’å…¥åŠ›                         â”‚
â”‚     ä¾‹: ws://192.168.1.100:9400/ws/agent                     â”‚
â”‚  2. auto_connect=true ãªã‚‰èµ·å‹•æ™‚ã«è‡ªå‹•æ¥ç¶š                     â”‚
â”‚  3. WebSocket æ¥ç¶š â†’ agent:auth ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡                â”‚
â”‚  4. server:welcome å—ä¿¡ â†’ Agent ID å–å¾—                      â”‚
â”‚  5. 30ç§’é–“éš”ã§ agent:heartbeat é€ä¿¡                          â”‚
â”‚     â”œ CPU/ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡                                        â”‚
â”‚     â”œ å®Ÿè¡Œä¸­ JOB æ•°                                          â”‚
â”‚     â”” é–‹ã„ã¦ã„ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§                               â”‚
â”‚  6. server:job:dispatch å—ä¿¡ â†’ JOB å®Ÿè¡Œé–‹å§‹                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 JOB å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```csharp
/// <summary>
/// Orchestrator ã‹ã‚‰é…ä¿¡ã•ã‚ŒãŸ JOB ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
/// Python Runtime ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµŒç”±ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã€
/// çµæœã‚’ WebSocket ã§ Orchestrator ã«å ±å‘Šã™ã‚‹ã€‚
/// </summary>
public class JobExecutionService
{
    public async Task ExecuteJobAsync(OrchestratorJobDispatch dispatch)
    {
        // 1. Orchestrator ã« job_started ã‚’é€šçŸ¥
        await _ws.SendAsync(new AgentJobStarted { ExecutionId = dispatch.ExecutionId });

        // 2. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯é–‹ã
        if (!string.IsNullOrEmpty(dispatch.DocumentPath))
            await _documentService.OpenDocumentAsync(dispatch.DocumentPath);

        // 3. Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œï¼ˆpython_runtime ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµŒç”±ï¼‰
        var result = await _pythonRuntime.ExecuteOnDocumentAsync(
            dispatch.Script,
            dispatch.Parameters,
            dispatch.TimeoutSeconds);

        // 4. å®Ÿè¡Œä¸­ã®ãƒ­ã‚°ã‚’ WebSocket ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€ä¿¡
        // ï¼ˆpython_runtime ã® stdout ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦è»¢é€ï¼‰

        // 5. Orchestrator ã« job_completed ã‚’é€šçŸ¥
        await _ws.SendAsync(new AgentJobCompleted
        {
            ExecutionId = dispatch.ExecutionId,
            Status = result.ExitCode == 0 ? "completed" : "failed",
            ExitCode = result.ExitCode,
            Stdout = result.Stdout,
            Stderr = result.Stderr,
            DocumentModified = result.DocumentModified,
            DurationMs = result.DurationMs,
        });
    }
}
```

#### 3.2.3 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```
Orchestrator ã‹ã‚‰ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©ã‚’å—ä¿¡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 0: å£²ä¸Šãƒ‡ãƒ¼ã‚¿.xlsx â†’ aggregate.py                       â”‚
â”‚  Step 1: æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ.docx â†’ fill_template.py                 â”‚
â”‚  Step 2: å ±å‘Šæ›¸.pptx â†’ gen_charts.py                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent å´ã®å®Ÿè¡Œ:                                              â”‚
â”‚                                                               â”‚
â”‚  for each step in workflow.Steps:                             â”‚
â”‚    â‘  open_document(step.DocumentPath)                        â”‚
â”‚    â‘¡ execute_job(step.Script, step.Parameters)               â”‚
â”‚    â‘¢ close_document(save: true)                              â”‚
â”‚    â‘£ WebSocket ã§ workflow_step_completed ã‚’é€ä¿¡              â”‚
â”‚                                                               â”‚
â”‚  å…¨ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†å¾Œ:                                             â”‚
â”‚    workflow_completed ã‚’é€ä¿¡                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆOrchestrator ä¸è¦ç‰ˆï¼‰

BIZ Insight Business Suite ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã€‚Orchestrator ãªã—ã§ãƒ­ãƒ¼ã‚«ãƒ« PC ä¸Šã®ç°¡æ˜“è‡ªå‹•åŒ–ãŒå¯èƒ½ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ UIï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰                          â”‚
â”‚                                                               â”‚
â”‚  ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å: [æœˆæœ«çµŒè²»é›†è¨ˆ            ]                    â”‚
â”‚                                                               â”‚
â”‚  å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“‚ C:\Users\user\Documents\çµŒè²»\                       â”‚  â”‚
â”‚  â”‚    ãƒ•ã‚£ãƒ«ã‚¿: *.xlsx                                     â”‚  â”‚
â”‚  â”‚    è©²å½“ãƒ•ã‚¡ã‚¤ãƒ«: 12 ä»¶                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚  å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆé †ç•ªã«å®Ÿè¡Œï¼‰:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ç©ºç™½è¡Œã®å‰Šé™¤ (clean_empty_rows)                      â”‚  â”‚
â”‚  â”‚ 2. ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆçµ±ä¸€ (normalize_format)                   â”‚  â”‚
â”‚  â”‚ 3. é›†è¨ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ (aggregate_expenses)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚  [ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³]  [å®Ÿè¡Œ]                                          â”‚
â”‚                                                               â”‚
â”‚  é€²æ—: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 8/12 ãƒ•ã‚¡ã‚¤ãƒ« (66%)                      â”‚
â”‚  ç¾åœ¨: çµŒè²»_2026_01.xlsx â€” Step 2/3                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 ãƒ—ãƒ©ãƒ³åˆ¥åˆ¶é™ï¼ˆRPA Agentï¼‰

| æ©Ÿèƒ½ | FREE | BIZ | ENT |
|------|:----:|:---:|:---:|
| bot_agentï¼ˆOrchestrator é€£æºï¼‰ | âŒ | âœ… | âœ… |
| local_workflowï¼ˆãƒ­ãƒ¼ã‚«ãƒ«è‡ªå‹•åŒ–ï¼‰ | âŒ | âœ… | âœ… |
| python_runtimeï¼ˆå‰æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ | âŒ | âœ… | âœ… |

â€» InsightBot (INBT) å´: BIZ = Agent 50å°ã€ENT = ç„¡åˆ¶é™

---

## 4. Pillar 3: ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

### 4.1 æ¦‚è¦

ã‚³ãƒ³ã‚µãƒ«å°å…¥å…ˆã® Insight Business Suite ã‚’**ãƒªãƒ¢ãƒ¼ãƒˆã§ä¸€å…ƒç®¡ç†**ã™ã‚‹ã€‚
ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è‡ªä½“ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ + ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆã®é…ä¿¡ + åˆ©ç”¨çŠ¶æ³ã®ç›£è¦–ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HARMONIC insight ç®¡ç†ã‚³ãƒ³ã‚½ãƒ¼ãƒ«                                    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰                                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ ç¨¼åƒç«¯æœ«  â”‚ â”‚ æœ€æ–°ç‡   â”‚ â”‚ åˆ©ç”¨çŠ¶æ³  â”‚ â”‚ ã‚¢ãƒ©ãƒ¼ãƒˆ  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ 245 å°   â”‚ â”‚ 92%     â”‚ â”‚ æœˆé–“ AI   â”‚ â”‚ 3 ä»¶     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚          â”‚ â”‚          â”‚ â”‚ 12,340å›  â”‚ â”‚          â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  ç«¯æœ«ä¸€è¦§:                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ ç«¯æœ«å  â”‚ è£½å“   â”‚ ãƒãƒ¼ã‚¸ãƒ§ãƒ³â”‚ ãƒ—ãƒ©ãƒ³ â”‚ çŠ¶æ…‹ â”‚ æœ€çµ‚æ¥ç¶š  â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ çµŒç†-1 â”‚ IOSH  â”‚ 2.0.0  â”‚ BIZ  â”‚ â— æœ€æ–°â”‚ 2åˆ†å‰    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ å–¶æ¥­-3 â”‚ INSS  â”‚ 2.0.1  â”‚ BIZ  â”‚ âš  æ—§ç‰ˆâ”‚ 1æ™‚é–“å‰  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ æ³•å‹™-2 â”‚ IOSD  â”‚ 1.0.0  â”‚ BIZ  â”‚ â—‹ é›¢ç·šâ”‚ 3æ—¥å‰    â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                    â”‚
â”‚                         REST API (HTTPS)                          â”‚
â”‚                              â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Insight Business Suite å„ç«¯æœ«                                     â”‚
â”‚                              â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ çµŒç†-1       â”‚  â”‚ å–¶æ¥­-3       â”‚  â”‚ æ³•å‹™-2       â”‚           â”‚
â”‚  â”‚ IOSH BIZ     â”‚  â”‚ INSS BIZ     â”‚  â”‚ IOSD BIZ     â”‚           â”‚
â”‚  â”‚ v2.0.0 âœ…    â”‚  â”‚ v2.0.1 âš ï¸    â”‚  â”‚ v1.0.0 â—‹    â”‚           â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚           â”‚
â”‚  â”‚ RemoteAgent  â”‚  â”‚ RemoteAgent  â”‚  â”‚ RemoteAgent  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ã®æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ | å¯¾è±¡ãƒ—ãƒ©ãƒ³ |
|------|------|:---------:|
| **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯** | æœ€æ–°ç‰ˆã®é€šçŸ¥ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ URL ã®é…ä¿¡ | å…¨ãƒ—ãƒ©ãƒ³ |
| **ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª** | èµ·å‹•å›æ•°ãƒ»AI åˆ©ç”¨å›æ•°ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ | BIZ/ENT |
| **ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡** | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆãƒ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§ã®ãƒªãƒ¢ãƒ¼ãƒˆæ›´æ–° | BIZ/ENT |
| **ãƒªãƒ¢ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ›´æ–°** | ã‚¢ãƒ‰ã‚¤ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ— | ENT |
| **ä½¿ç”¨çŠ¶æ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** | å…¨ç«¯æœ«ã®åˆ©ç”¨çŠ¶æ³ã‚’ä¸€å…ƒç›£è¦– | ENT |
| **ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ã‚°åé›†** | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®é›†ç´„ãƒ»åˆ†æ | ENT |

### 4.3 IOSH å´ã®å®Ÿè£…

```
InsightPerformanceManagement/
â”œâ”€â”€ RemoteManagement/                  â˜… æ–°è¦
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ VersionCheckService.cs        # èµ·å‹•æ™‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ TelemetryService.cs           # åˆ©ç”¨çŠ¶æ³ã®é€ä¿¡
â”‚   â”‚   â”œâ”€â”€ AdminProfileSyncService.cs    # ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—ãƒ»é©ç”¨
â”‚   â”‚   â””â”€â”€ RemoteLogService.cs           # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®é€ä¿¡
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ VersionInfo.cs
â”‚       â”œâ”€â”€ TelemetryEvent.cs
â”‚       â””â”€â”€ RemoteConfig.cs
```

#### 4.3.1 ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ãƒ•ãƒ­ãƒ¼

```
èµ·å‹•æ™‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. HTTPS GET /api/versions/{product}                        â”‚
â”‚     ãƒ¬ã‚¹ãƒãƒ³ã‚¹: { latest: "2.1.0", build: 46,                â”‚
â”‚                   downloadUrl: "...", releaseNotes: "..." }   â”‚
â”‚  2. ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ¯”è¼ƒ                                    â”‚
â”‚     - æœ€æ–° â†’ ä½•ã‚‚ã—ãªã„                                       â”‚
â”‚     - æ›´æ–°ã‚ã‚Š â†’ ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã«ã€Œæ›´æ–°ã‚ã‚Šã€ãƒãƒƒã‚¸è¡¨ç¤º          â”‚
â”‚       ã‚¯ãƒªãƒƒã‚¯ã§ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆ + ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯è¡¨ç¤º        â”‚
â”‚  3. å¼·åˆ¶æ›´æ–°ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹å ´åˆ â†’ æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º           â”‚
â”‚     (minRequiredVersion æœªæº€ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ–ãƒ­ãƒƒã‚¯)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.2 ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼ˆåˆ©ç”¨çŠ¶æ³ã®åŒ¿ååé›†ï¼‰

```csharp
/// <summary>
/// åˆ©ç”¨çŠ¶æ³ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã€‚
/// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæ„ãŒå‰æï¼ˆè¨­å®šç”»é¢ã§ã‚ªãƒ—ãƒˆã‚¢ã‚¦ãƒˆå¯èƒ½ï¼‰ã€‚
/// </summary>
public class TelemetryService
{
    /// <summary>
    /// å®šæœŸé€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆ1æ—¥1å› or ã‚¢ãƒ—ãƒªçµ‚äº†æ™‚ï¼‰
    /// </summary>
    public TelemetryPayload CollectTelemetry()
    {
        return new TelemetryPayload
        {
            // ç«¯æœ«è­˜åˆ¥ï¼ˆåŒ¿åãƒãƒƒã‚·ãƒ¥ï¼‰
            DeviceHash = HashDeviceId(),
            Product = "IOSH",
            Version = AppVersion,
            Plan = CurrentPlan,

            // åˆ©ç”¨çµ±è¨ˆ
            SessionCount = _stats.SessionCount,
            AiAssistantUsage = _stats.AiAssistantCalls,
            AiTransferUsage = _stats.AiTransferCalls,
            AiValidationUsage = _stats.AiValidationCalls,
            PythonScriptRuns = _stats.PythonRuns,

            // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ…‹
            EnabledModules = GetEnabledModuleIds(),

            // ã‚¨ãƒ©ãƒ¼ã‚µãƒãƒªãƒ¼
            ErrorCount = _stats.ErrorCount,
            CrashCount = _stats.CrashCount,

            // ç’°å¢ƒæƒ…å ±
            OsVersion = Environment.OSVersion.ToString(),
            DotNetVersion = Environment.Version.ToString(),
            Locale = CultureInfo.CurrentCulture.Name,
        };
    }
}
```

#### 4.3.3 ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡

```
ã‚³ãƒ³ã‚µãƒ«å°å…¥ãƒ•ãƒ­ãƒ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ã‚³ãƒ³ã‚µãƒ«ãŒç®¡ç†ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ               â”‚
â”‚     - æœ‰åŠ¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«: ai_assistant, data_collection           â”‚
â”‚     - ç„¡åŠ¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«: vrm_avatar, python_runtime              â”‚
â”‚     - ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: æœˆæœ«é›†è¨ˆ, ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆçµ±ä¸€          â”‚
â”‚                                                               â”‚
â”‚  2. ãƒ†ãƒŠãƒ³ãƒˆã«ç´ã¥ã‘ã¦é…ä¿¡                                    â”‚
â”‚     POST /api/admin/profiles                                  â”‚
â”‚                                                               â”‚
â”‚  3. Insight Business Suite èµ·å‹•æ™‚ã«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—          â”‚
â”‚     GET /api/profiles/{licenseKey}                            â”‚
â”‚                                                               â”‚
â”‚  4. %APPDATA%/HarmonicInsight/IOSH/admin-profile.json ã«ä¿å­˜  â”‚
â”‚                                                               â”‚
â”‚  5. AddonManager ãŒãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«å¾“ã£ã¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ¶å¾¡        â”‚
â”‚     - forcedEnabled â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç„¡åŠ¹åŒ–ã§ããªã„                 â”‚
â”‚     - disabledModules â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæœ‰åŠ¹åŒ–ã§ããªã„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 ã‚µãƒ¼ãƒãƒ¼å´ APIï¼ˆæ–°è¦è¨­è¨ˆï¼‰

```typescript
// ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ã‚µãƒ¼ãƒãƒ¼ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
const REMOTE_MANAGEMENT_API = {
  defaultPort: 9600,

  endpoints: {
    // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
    versions: {
      latest:  { method: 'GET',  path: '/api/versions/:product' },
      history: { method: 'GET',  path: '/api/versions/:product/history' },
      publish: { method: 'POST', path: '/api/versions/:product' },  // admin
    },

    // ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª
    telemetry: {
      submit:    { method: 'POST', path: '/api/telemetry' },
      dashboard: { method: 'GET',  path: '/api/telemetry/dashboard' },  // admin
      export:    { method: 'GET',  path: '/api/telemetry/export' },     // admin
    },

    // ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    profiles: {
      get:    { method: 'GET',  path: '/api/profiles/:licenseKey' },
      create: { method: 'POST', path: '/api/admin/profiles' },
      update: { method: 'PUT',  path: '/api/admin/profiles/:profileId' },
      assign: { method: 'POST', path: '/api/admin/profiles/:profileId/assign' },
    },

    // ç«¯æœ«ç®¡ç†ï¼ˆadminï¼‰
    devices: {
      list:   { method: 'GET',  path: '/api/admin/devices' },
      detail: { method: 'GET',  path: '/api/admin/devices/:deviceHash' },
    },
  },
};
```

---

## 5. å“è³ªä¿è­·æˆ¦ç•¥ â€” ã‚³ã‚¢æ©Ÿèƒ½ã‚’å®ˆã‚ŠãªãŒã‚‰æ‹¡å¼µã™ã‚‹

### 5.1 å•é¡Œèªè­˜

Insight Business Suite ã®æœ€å¤§ã®ä¾¡å€¤ã¯ã€ŒExcel/Word/PowerPoint ã®èª­ã¿æ›¸ããƒ»ç·¨é›†ãŒå®‰å®šå‹•ä½œã™ã‚‹ã€ã“ã¨ã€‚
ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»RPA Agentãƒ»ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ã®è¿½åŠ ã§**ã‚³ã‚¢å“è³ªãŒåŠ£åŒ–ã™ã‚‹ãƒªã‚¹ã‚¯**ã‚’å›é¿ã™ã‚‹ã€‚

### 5.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹åˆ†é›¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚³ã‚¢å±¤ï¼ˆå¤‰æ›´ã—ãªã„ï¼‰                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Excel èª­ã¿æ›¸ã â”‚ ã‚»ãƒ«ç·¨é›† â”‚ æ›¸å¼ â”‚ æ•°å¼ â”‚ ä¿å­˜ â”‚ å°åˆ·   â”‚â”‚
â”‚  â”‚ Syncfusion XlsIO / SfSpreadsheet                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                               â”‚
â”‚  æ‹¡å¼µå±¤ï¼ˆAddonManager ã§åˆ†é›¢ï¼‰                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚AI ï½±ï½¼ï½½ï¾€ï¾ï¾„â”‚ â”‚ãƒ‡ãƒ¼ã‚¿åé›†â”‚ â”‚RPA Agentâ”‚ â”‚ï¾˜ï¾“ï½°ï¾„ç®¡ç† â”‚       â”‚
â”‚  â”‚(æ—¢å­˜)    â”‚ â”‚(æ–°è¦)    â”‚ â”‚(æ–°è¦)    â”‚ â”‚(æ–°è¦)    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                               â”‚
â”‚  â˜… æ‹¡å¼µå±¤ã®ãƒã‚°ãŒã‚³ã‚¢å±¤ã«å½±éŸ¿ã—ãªã„è¨­è¨ˆ                        â”‚
â”‚  â˜… å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ç‹¬ç«‹ã—ã¦æœ‰åŠ¹/ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½               â”‚
â”‚  â˜… å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç„¡åŠ¹åŒ– = å¾“æ¥ã®å®‰å®šç‰ˆã¨åŒç­‰ã®å‹•ä½œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŸå‰‡: æ–°æ©Ÿèƒ½ã¯ã‚³ã‚¢å±¤ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãªã„ã€‚**
ã™ã¹ã¦ AddonManager çµŒç”±ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®Ÿè£…ã—ã€ã‚³ã‚¢ã® SfSpreadsheet / XlsIO ã®ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã¯è§¦ã‚‰ãªã„ã€‚

### 5.3 å“è³ªã‚²ãƒ¼ãƒˆï¼ˆå®Ÿè£…ãƒ«ãƒ¼ãƒ«ï¼‰

| # | ãƒ«ãƒ¼ãƒ« | ç†ç”± |
|:-:|--------|------|
| 1 | **ã‚³ã‚¢å±¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰æ›´ç¦æ­¢** | Excel èª­ã¿æ›¸ããƒ»ä¿å­˜ãƒ»å°åˆ·ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯è§¦ã‚‰ãªã„ |
| 2 | **æ–°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ try-catch ã§å›²ã‚€** | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®ä¾‹å¤–ãŒã‚³ã‚¢ã«æ³¢åŠã—ãªã„ |
| 3 | **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç„¡åŠ¹æ™‚ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿ã‚¼ãƒ­** | ç„¡åŠ¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä¸€åˆ‡ãƒ­ãƒ¼ãƒ‰ã—ãªã„ |
| 4 | **HTTP é€šä¿¡ã¯éåŒæœŸ + ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¿…é ˆ** | ã‚µãƒ¼ãƒãƒ¼ä¸é”ã§ã‚¢ãƒ—ãƒªãŒãƒ•ãƒªãƒ¼ã‚ºã—ãªã„ |
| 5 | **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ãƒ‡ã‚°ãƒ¬ãƒ¼ãƒ‰** | ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šä¸å¯ã§ã‚‚ã‚³ã‚¢æ©Ÿèƒ½ã¯100%å‹•ä½œ |
| 6 | **æ–°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯å€‹åˆ¥ã« E2E ãƒ†ã‚¹ãƒˆ** | ã‚³ã‚¢æ©Ÿèƒ½ã®ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã¨åˆ†é›¢ |
| 7 | **ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç›£è¦–** | WebSocket å¸¸æ™‚æ¥ç¶šç­‰ã§é•·æ™‚é–“ç¨¼åƒæ™‚ã®åŠ£åŒ–ã‚’é˜²æ­¢ |
| 8 | **ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§æ®µéšæŠ•å…¥** | å•é¡Œç™ºç”Ÿæ™‚ã« `disabledModules` ã§å³åº§ã«ç„¡åŠ¹åŒ– |

### 5.4 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«éšœå®³æ™‚ã®æŒ™å‹•

```csharp
/// <summary>
/// AddonManager ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–å¤±æ•—æ™‚ã«ã‚³ã‚¢èµ·å‹•ã‚’å¦¨ã’ãªã„ã€‚
/// </summary>
public class AddonManager
{
    public void InitializeModules()
    {
        foreach (var module in _enabledModules)
        {
            try
            {
                module.Initialize();
                _logger.Info($"Module {module.Id} initialized successfully");
            }
            catch (Exception ex)
            {
                // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–å¤±æ•— â†’ ç„¡åŠ¹åŒ–ã—ã¦ã‚³ã‚¢èµ·å‹•ã‚’ç¶šè¡Œ
                _logger.Error($"Module {module.Id} failed to initialize: {ex.Message}");
                module.State = AddonState.Disabled;
                DisableModule(module.Id);

                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥ï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰
                ShowToast($"{module.NameJa} ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ©Ÿèƒ½ã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚");
            }
        }
    }
}
```

### 5.5 æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹æˆ¦ç•¥

```
Phase    ãƒªãƒªãƒ¼ã‚¹å†…å®¹                     å“è³ªç¢ºèª
â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”€â”€â”€â”€â”€â”€â”€â”€
Î±        ãƒ‡ãƒ¼ã‚¿åé›†ã®ã¿ï¼ˆç¤¾å†…ãƒ†ã‚¹ãƒˆï¼‰       ã‚³ã‚¢æ©Ÿèƒ½ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
Î²-1      ãƒ‡ãƒ¼ã‚¿åé›†ï¼ˆé™å®šé¡§å®¢3ç¤¾ï¼‰          1é€±é–“ã®å®Ÿé‹ç”¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
Î²-2      + RPA Agentï¼ˆç¤¾å†…ãƒ†ã‚¹ãƒˆï¼‰          ãƒ¡ãƒ¢ãƒªãƒ»CPUãƒ»å®‰å®šæ€§ãƒ†ã‚¹ãƒˆ
GA       ãƒ‡ãƒ¼ã‚¿åé›† + RPA Agent             å…¨ãƒ†ã‚¹ãƒˆåˆæ ¼ + 2é€±é–“ã®å®‰å®šç¨¼åƒ
GA+1     + ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†                     ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã§å…¨ç«¯æœ«ã®å¥å…¨æ€§ç¢ºèª
```

### 5.6 ã‚³ã‚¢æ©Ÿèƒ½ã®ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆé …ç›®

æ–°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ ã®ãŸã³ã«ã€ä»¥ä¸‹ã®ã‚³ã‚¢æ©Ÿèƒ½ãŒåŠ£åŒ–ã—ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ï¼š

| # | ãƒ†ã‚¹ãƒˆé …ç›® | åˆæ ¼åŸºæº– |
|:-:|-----------|---------|
| 1 | .xlsx ã®èª­ã¿è¾¼ã¿ï¼ˆ100MB ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ | 3ç§’ä»¥å†… |
| 2 | ã‚»ãƒ«ç·¨é›†ï¼ˆé€£ç¶š 1000 ã‚»ãƒ«å…¥åŠ›ï¼‰ | å…¥åŠ›é…å»¶ãªã— |
| 3 | æ•°å¼ã®å†è¨ˆç®—ï¼ˆ10,000 ã‚»ãƒ«ï¼‰ | å³åº§ã«å®Œäº† |
| 4 | .xlsx ä¿å­˜ | ãƒ‡ãƒ¼ã‚¿æ¬ æãªã— |
| 5 | .iosh ä¿å­˜ / å†èª­ã¿è¾¼ã¿ | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å«ã‚å®Œå…¨å¾©å…ƒ |
| 6 | å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ | ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œãªã— |
| 7 | èµ·å‹•æ™‚é–“ï¼ˆå…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœ‰åŠ¹ï¼‰ | 5ç§’ä»¥å†… |
| 8 | èµ·å‹•æ™‚é–“ï¼ˆå…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç„¡åŠ¹ï¼‰ | 3ç§’ä»¥å†…ï¼ˆ= å¾“æ¥ã¨åŒç­‰ï¼‰ |
| 9 | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ï¼ˆ1æ™‚é–“ç¨¼åƒå¾Œï¼‰ | 500MB ä»¥ä¸‹ |
| 10 | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ï¼ˆ8æ™‚é–“ç¨¼åƒå¾Œï¼‰ | 800MB ä»¥ä¸‹ï¼ˆãƒªãƒ¼ã‚¯æ¤œå‡ºï¼‰ |

### 5.7 æŠ€è¡“æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆå®Ÿè£…å‰ã«ç¢ºèªï¼‰

å„ Pillar ã®å®Ÿè£…å‰ã«ã€ä»¥ä¸‹ã®æŠ€è¡“æ¤œè¨¼ã‚’è¡Œã†ï¼š

#### Pillar 1: ãƒ‡ãƒ¼ã‚¿åé›†

- [ ] SfSpreadsheet ã«å‹•çš„ã«ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ã—ãŸéš›ã®å®‰å®šæ€§
- [ ] Sheet Protectionï¼ˆNamed Ranges ã®ã¿ Unlockï¼‰ã® Syncfusion API å‹•ä½œç¢ºèª
- [ ] Named Ranges ã®èª­ã¿æ›¸ãï¼ˆXlsIOï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- [ ] é€šå¸¸ã‚·ãƒ¼ãƒˆã¨ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ãƒ¼ãƒˆã®æ··åœ¨æ™‚ã®ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ .xlsx ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ + ãƒ¡ãƒ¢ãƒªç®¡ç†
- [ ] REST API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»ãƒªãƒˆãƒ©ã‚¤æŒ™å‹•
- [ ] .iosh ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ä¸‹æ›¸ãä¿å­˜ï¼ˆZIP å†…ã«è¿½åŠ ãƒ‘ã‚¹ï¼‰

#### Pillar 2: RPA Agent

- [ ] WebSocket (System.Net.WebSockets) ã®é•·æ™‚é–“æ¥ç¶šå®‰å®šæ€§
- [ ] ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆ 30ç§’é–“éš”ã®ãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»
- [ ] Python subprocess ã®èµ·å‹•ãƒ»çµ‚äº†ã®ç¢ºå®Ÿæ€§
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® open â†’ Python å‡¦ç† â†’ save â†’ close ã®ã‚µã‚¤ã‚¯ãƒ«
- [ ] è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«é †æ¬¡å‡¦ç†æ™‚ã®ãƒ¡ãƒ¢ãƒªè§£æ”¾
- [ ] Orchestrator æ¥ç¶šæ–­æ™‚ã®ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ãƒ‡ã‚°ãƒ¬ãƒ¼ãƒ‰

#### Pillar 3: ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†

- [ ] èµ·å‹•æ™‚ HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼‰ã®èµ·å‹•æ™‚é–“ã¸ã®å½±éŸ¿
- [ ] ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªé€ä¿¡ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ
- [ ] ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã® JSON ãƒ‘ãƒ¼ã‚¹ãƒ»é©ç”¨ã®å®‰å…¨æ€§

---

## 6. å®Ÿè£…å„ªå…ˆé †ä½ã¨ãƒ•ã‚§ãƒ¼ã‚ºè¨ˆç”»

### Phase 1: ãƒ‡ãƒ¼ã‚¿åé›†ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆæœ€å„ªå…ˆï¼‰

**ç†ç”±**: ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆAPI + DB + ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ãŒå®Œæˆæ¸ˆã¿ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚Œã°å³åº§ã«å°å…¥å¯èƒ½ã€‚

```
Phase 1-A: åŸºæœ¬æ©Ÿèƒ½ï¼ˆ4-6 é€±é–“ï¼‰
â”œâ”€â”€ DataCollectionApiClient.csï¼ˆREST API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰
â”œâ”€â”€ TemplateManager.csï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ + è¡¨ç¤ºï¼‰
â”œâ”€â”€ SheetProtectionService.csï¼ˆNamed Range ãƒ­ãƒƒã‚¯ï¼‰
â”œâ”€â”€ DataExtractor.csï¼ˆã‚»ãƒ« â†’ JSON å¤‰æ›ï¼‰
â”œâ”€â”€ å³ãƒ‘ãƒãƒ« UIï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ + æ“ä½œãƒœã‚¿ãƒ³ï¼‰
â”œâ”€â”€ é€ä¿¡ãƒ•ãƒ­ãƒ¼ï¼ˆextract â†’ validate â†’ submitï¼‰
â””â”€â”€ ä¸‹æ›¸ãä¿å­˜ãƒ»å¾©å…ƒ

Phase 1-B: AI æ©Ÿèƒ½ï¼ˆ2-3 é€±é–“ï¼‰
â”œâ”€â”€ AiTransferService.csï¼ˆAI è‡ªå‹•è»¢è¨˜ï¼‰
â”œâ”€â”€ AiValidationService.csï¼ˆAI æ¤œè¨¼ï¼‰
â”œâ”€â”€ AI è»¢è¨˜çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ UI
â”œâ”€â”€ AI æ¤œè¨¼çµæœã®è‰²åˆ†ã‘è¡¨ç¤º
â””â”€â”€ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚²ãƒ¼ãƒˆï¼ˆæœˆæ¬¡å›æ•°åˆ¶é™ï¼‰

Phase 1-C: å“è³ªå‘ä¸Šï¼ˆ1-2 é€±é–“ï¼‰
â”œâ”€â”€ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼ˆä¸‹æ›¸ãã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ + æ¥ç¶šå›å¾©æ™‚åŒæœŸï¼‰
â”œâ”€â”€ å…¥åŠ›é€²æ—ãƒãƒ¼
â”œâ”€â”€ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒªãƒˆãƒ©ã‚¤
â””â”€â”€ ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ—¥æœ¬èª + è‹±èªï¼‰
```

### Phase 2: RPA Agent

**ç†ç”±**: InsightBot (INBT) å´ã® Orchestrator å®Ÿè£…ã¨ä¸¦è¡Œã€‚

```
Phase 2-A: Agent åŸºæœ¬ï¼ˆ3-4 é€±é–“ï¼‰
â”œâ”€â”€ AgentConnectionService.csï¼ˆWebSocket æ¥ç¶šï¼‰
â”œâ”€â”€ HeartbeatService.csï¼ˆ30ç§’é–“éš”ï¼‰
â”œâ”€â”€ JobExecutionService.csï¼ˆJOB å—ä¿¡ â†’ å®Ÿè¡Œ â†’ å ±å‘Šï¼‰
â”œâ”€â”€ DocumentOperationService.csï¼ˆopen/closeï¼‰
â””â”€â”€ è¨­å®š UIï¼ˆOrchestrator URLã€è¡¨ç¤ºåã€è‡ªå‹•æ¥ç¶šï¼‰

Phase 2-B: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ2-3 é€±é–“ï¼‰
â”œâ”€â”€ WorkflowExecutionService.csï¼ˆè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«é †æ¬¡å‡¦ç†ï¼‰
â”œâ”€â”€ ã‚¹ãƒ†ãƒƒãƒ—é–“ã®ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—
â””â”€â”€ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆstop/skip/retryï¼‰

Phase 2-C: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ2 é€±é–“ï¼‰
â”œâ”€â”€ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ UIï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰
â”œâ”€â”€ ãƒ•ã‚©ãƒ«ãƒ€å†…ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†
â””â”€â”€ é€²æ—è¡¨ç¤ºãƒ»çµæœãƒ¬ãƒãƒ¼ãƒˆ
```

### Phase 3: ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†

**ç†ç”±**: å°å…¥å…ˆãŒå¢—ãˆã¦ã‹ã‚‰æœ¬æ ¼çš„ã«å¿…è¦ã«ãªã‚‹ã€‚

```
Phase 3-A: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆ1-2 é€±é–“ï¼‰
â”œâ”€â”€ VersionCheckService.cs
â”œâ”€â”€ ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã®æ›´æ–°é€šçŸ¥ãƒãƒƒã‚¸
â””â”€â”€ ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆ + ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯

Phase 3-B: ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼ˆ2-3 é€±é–“ï¼‰
â”œâ”€â”€ TelemetryService.cs
â”œâ”€â”€ ã‚ªãƒ—ãƒˆã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆè¨­å®š UI
â””â”€â”€ ã‚µãƒ¼ãƒãƒ¼å´ API + ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

Phase 3-C: ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ï¼ˆ2-3 é€±é–“ï¼‰
â”œâ”€â”€ AdminProfileSyncService.cs
â”œâ”€â”€ èµ·å‹•æ™‚ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ãƒ»é©ç”¨
â””â”€â”€ ç®¡ç†ã‚³ãƒ³ã‚½ãƒ¼ãƒ« UI
```

---

## 7. å…±é€šã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆå…¨ Pillar ã§å…±æœ‰ï¼‰

### 6.1 HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåŸºç›¤

```csharp
/// <summary>
/// Insight Business Suite å…¨ä½“ã§å…±æœ‰ã™ã‚‹ HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåŸºç›¤ã€‚
/// ãƒ‡ãƒ¼ã‚¿åé›† / RPA Agent / ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ã§å…±é€šä½¿ç”¨ã€‚
/// </summary>
public class InsightHttpClient
{
    // å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼
    private readonly string _licenseKey;  // X-Insight-License-Key
    private readonly string _userEmail;   // X-Insight-User-Email (Level 2+)
    private readonly string _product;     // X-Insight-Product
    private readonly string _version;     // X-Insight-Version

    // ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼ï¼ˆPollyï¼‰
    // - 429 Too Many Requests â†’ æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
    // - 5xx â†’ 3å›ãƒªãƒˆãƒ©ã‚¤
    // - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ â†’ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ

    // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚­ãƒ¥ãƒ¼
    // - é€ä¿¡å¤±æ•—ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚­ãƒ¥ãƒ¼ã«ä¿å­˜
    // - æ¥ç¶šå›å¾©æ™‚ã«ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å†é€ä¿¡
}
```

### 6.2 AddonManager ã¸ã®çµ±åˆ

```csharp
// æ—¢å­˜ã® AddonManager ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç™»éŒ²

// Pillar 1: ãƒ‡ãƒ¼ã‚¿åé›†
addonManager.RegisterModule(new DataCollectionModule());

// Pillar 2: RPA Agent
addonManager.RegisterModule(new BotAgentModule());
addonManager.RegisterModule(new LocalWorkflowModule());

// Pillar 3: ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†
// â†’ AddonModule ã§ã¯ãªãã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦çµ„ã¿è¾¼ã¿
// ï¼ˆå…¨ãƒ—ãƒ©ãƒ³ã§å‹•ä½œã™ã‚‹åŸºç›¤æ©Ÿèƒ½ã®ãŸã‚ï¼‰
```

### 6.3 è¨­å®šã®ä¿å­˜å…ˆ

```
%APPDATA%/HarmonicInsight/InsightPerformanceManagement/
â”œâ”€â”€ settings.json              # æ—¢å­˜: ä¸€èˆ¬è¨­å®š
â”œâ”€â”€ license.json               # æ—¢å­˜: ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æƒ…å ±
â”œâ”€â”€ admin-profile.json         # Pillar 3: ç®¡ç†è€…ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ telemetry-queue.json       # Pillar 3: æœªé€ä¿¡ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª
â”œâ”€â”€ data-collection/           # Pillar 1: ãƒ‡ãƒ¼ã‚¿åé›†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚   â”œâ”€â”€ templates/             # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ drafts/                # ãƒ­ãƒ¼ã‚«ãƒ«ä¸‹æ›¸ã
â”‚   â””â”€â”€ sync-queue.json        # æœªåŒæœŸã‚­ãƒ¥ãƒ¼
â””â”€â”€ bot-agent/                 # Pillar 2: Agent è¨­å®š
    â”œâ”€â”€ agent-config.json      # Orchestrator æ¥ç¶šæƒ…å ±
    â””â”€â”€ workflows/             # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©
```

---

## 8. ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—

```
Pillar 3 (ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†)
  â””â”€â”€ InsightHttpClient (å…±é€š HTTP åŸºç›¤)

Pillar 1 (ãƒ‡ãƒ¼ã‚¿åé›†)
  â”œâ”€â”€ InsightHttpClient
  â”œâ”€â”€ DataCollectionApiClient
  â”œâ”€â”€ Syncfusion XlsIO (Named Ranges)
  â”œâ”€â”€ Syncfusion SfSpreadsheet (UI)
  â”œâ”€â”€ Claude API (AI è»¢è¨˜ãƒ»æ¤œè¨¼)
  â””â”€â”€ AddonManager (data_collection ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)

Pillar 2 (RPA Agent)
  â”œâ”€â”€ InsightHttpClient
  â”œâ”€â”€ WebSocket (System.Net.WebSockets)
  â”œâ”€â”€ python_runtime ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (å‰æ)
  â””â”€â”€ AddonManager (bot_agent / local_workflow ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
```

---

## 9. ãƒ‡ãƒ¼ã‚¿åé›†ãƒ¢ãƒ¼ãƒ‰ã¨é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ

IOSH ã¯ã€Œé€šå¸¸ã® AI ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€ã¨ã€Œãƒ‡ãƒ¼ã‚¿åé›†ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ã® 2 ãƒ¢ãƒ¼ãƒ‰ã‚’æŒã¤ã€‚
ä¸¡ãƒ¢ãƒ¼ãƒ‰ã¯åŒæ™‚ã«åˆ©ç”¨å¯èƒ½ï¼ˆé€šå¸¸ã‚·ãƒ¼ãƒˆã¨ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ãƒ¼ãƒˆãŒæ··åœ¨ã™ã‚‹ï¼‰ã€‚

### ãƒ¢ãƒ¼ãƒ‰æ¯”è¼ƒ

| é …ç›® | é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ | ãƒ‡ãƒ¼ã‚¿åé›†ãƒ¢ãƒ¼ãƒ‰ |
|------|----------|---------------|
| **ã‚·ãƒ¼ãƒˆã‚¿ãƒ–** | ç™½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ | **é’ï¼ˆ#2563EBï¼‰** |
| **ç·¨é›†ç¯„å›²** | å…¨ã‚»ãƒ« | **Named Ranges ã®ã¿** |
| **å³ãƒ‘ãƒãƒ«** | AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ | **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ + æ“ä½œãƒ‘ãƒãƒ«** |
| **ãƒªãƒœãƒ³** | å…¨æ©Ÿèƒ½æœ‰åŠ¹ | **æ›¸å¼ç³»ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆ** |
| **ä¿å­˜å…ˆ** | .iosh ãƒ­ãƒ¼ã‚«ãƒ« | **.iosh ãƒ­ãƒ¼ã‚«ãƒ« + ã‚µãƒ¼ãƒãƒ¼é€ä¿¡** |
| **AI æ©Ÿèƒ½** | ä¸€èˆ¬çš„ãª AI æ”¯æ´ | **AI è‡ªå‹•è»¢è¨˜ + AI æ¤œè¨¼** |
| **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹** | BIZ ä»¥ä¸Š | **BIZ/ENT ã®ã¿** |

### åˆ‡ã‚Šæ›¿ãˆ UI

```
ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Insight Sheet  v2.0.0  â— BIZ  [ğŸ“Šé€šå¸¸] [ğŸ“‹ãƒ‡ãƒ¼ã‚¿åé›†] ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†‘ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ

ã€Œãƒ‡ãƒ¼ã‚¿åé›†ã€ã‚¿ãƒ–ã‚’é¸æŠã™ã‚‹ã¨:
- å³ãƒ‘ãƒãƒ«ãŒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ãƒ¼ãƒˆãŒè¿½åŠ ã•ã‚Œã‚‹
- é€šå¸¸ã‚·ãƒ¼ãƒˆã®ã‚¿ãƒ–ã¯ç™½ã®ã¾ã¾æ®‹ã‚Šã€è‡ªç”±ã«åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
```

---

## 10. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Pillar 1: ãƒ‡ãƒ¼ã‚¿åé›†ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

- [ ] `DataCollectionApiClient.cs` â€” å…¨ REST ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ + SfSpreadsheet è¡¨ç¤º
- [ ] Sheet Protectionï¼ˆNamed Ranges ã®ã¿ Unlockï¼‰
- [ ] `DataExtractor.cs` â€” Named Range â†’ JSON å¤‰æ›
- [ ] å³ãƒ‘ãƒãƒ« UIï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ + ç· åˆ‡è¡¨ç¤º + ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰
- [ ] å…¥åŠ›é€²æ—ãƒãƒ¼ï¼ˆfilled / total ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
- [ ] AI è‡ªå‹•è»¢è¨˜ï¼ˆClaude API é€£æºï¼‰
- [ ] AI è»¢è¨˜çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆconfidence è¡¨ç¤º + è¦ç¢ºèªãƒã‚¤ãƒ©ã‚¤ãƒˆï¼‰
- [ ] AI æ¤œè¨¼ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ + Claude APIï¼‰
- [ ] æ¤œè¨¼çµæœã®ã‚»ãƒ«è‰²åˆ†ã‘ï¼ˆç·‘/é»„/èµ¤ï¼‰
- [ ] é€ä¿¡ãƒ•ãƒ­ãƒ¼ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° + API POSTï¼‰
- [ ] ä¸‹æ›¸ãè‡ªå‹•ä¿å­˜ï¼ˆãƒ­ãƒ¼ã‚«ãƒ« + ã‚µãƒ¼ãƒãƒ¼åŒæœŸï¼‰
- [ ] ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ä¸‹æ›¸ã â†’ æ¥ç¶šå›å¾©æ™‚åŒæœŸï¼‰
- [ ] ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚²ãƒ¼ãƒˆï¼ˆBIZ/ENT ãƒã‚§ãƒƒã‚¯ + æœˆæ¬¡å›æ•°åˆ¶é™ï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿åé›†ãƒ¢ãƒ¼ãƒ‰ã¨é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ UI
- [ ] ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ—¥æœ¬èª + è‹±èªï¼‰

### Pillar 2: RPA Agent

- [ ] `AgentConnectionService.cs` â€” WebSocket æ¥ç¶šç®¡ç†
- [ ] `HeartbeatService.cs` â€” 30ç§’é–“éš”ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆ
- [ ] `JobExecutionService.cs` â€” JOB å—ä¿¡ãƒ»å®Ÿè¡Œãƒ»å ±å‘Š
- [ ] `DocumentOperationService.cs` â€” open/close/save
- [ ] `WorkflowExecutionService.cs` â€” è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«é †æ¬¡å‡¦ç†
- [ ] Agent è¨­å®š UIï¼ˆOrchestrator URLã€è¡¨ç¤ºåã€è‡ªå‹•æ¥ç¶šï¼‰
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ UI + å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
- [ ] ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚²ãƒ¼ãƒˆï¼ˆPRO/ENT ãƒã‚§ãƒƒã‚¯ï¼‰

### Pillar 3: ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†

- [ ] `VersionCheckService.cs` â€” èµ·å‹•æ™‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
- [ ] æ›´æ–°é€šçŸ¥ UIï¼ˆã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ãƒãƒƒã‚¸ + ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆï¼‰
- [ ] `TelemetryService.cs` â€” åˆ©ç”¨çŠ¶æ³ã®åŒ¿ååé›†
- [ ] ã‚ªãƒ—ãƒˆã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆè¨­å®š UI
- [ ] `AdminProfileSyncService.cs` â€” ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—ãƒ»é©ç”¨
- [ ] ã‚µãƒ¼ãƒãƒ¼å´ APIï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† + ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª + ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- [ ] ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆç«¯æœ«ä¸€è¦§ + åˆ©ç”¨çµ±è¨ˆï¼‰

---

## 11. å‚ç…§å…ˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ / ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ |
|----------------------|------|
| `config/data-collection.ts` | ãƒ‡ãƒ¼ã‚¿åé›†ã®å‹å®šç¾©ãƒ»APIãƒ»DB ã‚¹ã‚­ãƒ¼ãƒãƒ»ãƒ—ãƒ©ãƒ³åˆ¶é™ |
| `config/orchestrator.ts` | Orchestrator â†” Agent é–“ã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ»å‹å®šç¾© |
| `config/addon-modules.ts` | ã‚¢ãƒ‰ã‚¤ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®šç¾©ï¼ˆbot_agent / data_collection / local_workflowï¼‰ |
| `config/products.ts` | è£½å“å®šç¾© + ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚­ãƒ¼ï¼ˆdata_collection / ai_editorï¼‰ |
| `config/ai-assistant.ts` | AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆå…±é€šä»•æ§˜ï¼ˆClaude API ãƒ¢ãƒ‡ãƒ«ç®¡ç†ï¼‰ |
| `config/project-file.ts` | .iosh ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ï¼ˆZIP å†…ãƒ‘ã‚¹ï¼‰ |
| `standards/CSHARP_WPF.md` | C# WPF é–‹ç™ºæ¨™æº–ï¼ˆIvory & Gold / ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ï¼‰ |
| `templates/web-api-data-collection/` | ãƒ‡ãƒ¼ã‚¿åé›†ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…ï¼ˆHono + Supabaseï¼‰ |
| `CLAUDE.md` | å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ»ç¦æ­¢äº‹é …ãƒ»é–‹ç™ºãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ |
