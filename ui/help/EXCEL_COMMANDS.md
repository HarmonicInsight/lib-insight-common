# Excel コマンド集 - よく使う操作リファレンス

> Excel の基本操作からよく使う関数・ショートカットまで、まとめて確認できるリファレンスです。
> ITが得意でない方でもわかるように、やさしく説明しています。

---

## 目次

1. [基本のキーボード操作](#1-基本のキーボード操作)
2. [セルの選択・移動](#2-セルの選択移動)
3. [データ入力のコツ](#3-データ入力のコツ)
4. [よく使う関数（基本編）](#4-よく使う関数基本編)
5. [よく使う関数（集計編）](#5-よく使う関数集計編)
6. [よく使う関数（文字列編）](#6-よく使う関数文字列編)
7. [よく使う関数（日付編）](#7-よく使う関数日付編)
8. [よく使う関数（検索・参照編）](#8-よく使う関数検索参照編)
9. [よく使う関数（条件付き編）](#9-よく使う関数条件付き編)
10. [表示形式（セルの書式設定）](#10-表示形式セルの書式設定)
11. [印刷のコツ](#11-印刷のコツ)
12. [エラー値の意味と対処法](#12-エラー値の意味と対処法)
13. [Insight Performance Management 固有のコマンド](#13-harmonicsheet-固有のコマンド)

---

## 1. 基本のキーボード操作

### ファイル操作

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 新規作成 | Ctrl + N | 新しいブック（ファイル）を作成 |
| 開く | Ctrl + O | 既存のファイルを開く |
| 上書き保存 | Ctrl + S | 現在のファイルを保存 |
| 名前を付けて保存 | F12 / Ctrl + Shift + S | 別の名前で保存 |
| 印刷 | Ctrl + P | 印刷ダイアログを開く |
| 閉じる | Ctrl + W | 現在のブックを閉じる |

### 編集操作

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 元に戻す | Ctrl + Z | 直前の操作を取り消す |
| やり直す | Ctrl + Y | 「元に戻す」を取り消す |
| コピー | Ctrl + C | 選択範囲をコピー |
| 切り取り | Ctrl + X | 選択範囲を切り取り |
| 貼り付け | Ctrl + V | コピーした内容を貼り付け |
| 値のみ貼り付け | Ctrl + Shift + V | 書式なしで値だけ貼り付け |
| すべて選択 | Ctrl + A | シート全体を選択 |
| 検索 | Ctrl + F | 文字を検索 |
| 置換 | Ctrl + H | 文字を置換 |
| セルの削除 | Delete | セルの内容を削除（書式は残る） |

---

## 2. セルの選択・移動

### 移動

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 上下左右に移動 | 矢印キー | 1セルずつ移動 |
| データの端まで移動 | Ctrl + 矢印キー | データが入っている最後のセルまで一気に移動 |
| シートの先頭へ | Ctrl + Home | A1セルに移動 |
| シートの末尾へ | Ctrl + End | データが入っている最後のセルに移動 |
| 指定セルへ移動 | Ctrl + G / F5 | セル番地を指定して移動（例: B15） |

### 範囲選択

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 範囲を選択 | Shift + 矢印キー | 1セルずつ選択範囲を広げる |
| データの端まで選択 | Ctrl + Shift + 矢印キー | データの端まで一気に選択 |
| 列全体を選択 | Ctrl + Space | 現在の列全体を選択 |
| 行全体を選択 | Shift + Space | 現在の行全体を選択 |
| 離れたセルも選択 | Ctrl + クリック | 離れた場所を追加で選択 |

> **ヒント**: `Ctrl + 矢印キー` はデータの端まで一気に飛べるので、大きな表の中を素早く移動するのに便利です。

---

## 3. データ入力のコツ

### 入力の確定

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 入力して下へ | Enter | 入力を確定して1つ下のセルへ |
| 入力して上へ | Shift + Enter | 入力を確定して1つ上のセルへ |
| 入力して右へ | Tab | 入力を確定して1つ右のセルへ |
| 入力して左へ | Shift + Tab | 入力を確定して1つ左のセルへ |
| セル内で改行 | Alt + Enter | セルの中で改行する |
| 入力のキャンセル | Esc | 入力をキャンセル |

### 便利な入力操作

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 今日の日付を入力 | Ctrl + ; | 今日の日付を自動入力 |
| 現在の時刻を入力 | Ctrl + : | 現在の時刻を自動入力 |
| 上のセルをコピー | Ctrl + D | すぐ上のセルの値をコピー |
| 左のセルをコピー | Ctrl + R | すぐ左のセルの値をコピー |
| 同じ値を複数セルに | Ctrl + Enter | 選択した全セルに同じ値を入力 |
| 連続データの入力 | フィルハンドル | セル右下の■をドラッグ（1,2,3... や 月,火,水...） |

> **ヒント**: フィルハンドル（セル右下の小さな■）をドラッグすると、連続した数値や日付を自動入力できます。

---

## 4. よく使う関数（基本編）

### SUM - 合計を求める

数値の合計を計算します。

```
=SUM(B2:B10)       → B2からB10までの合計
=SUM(B2,B5,B8)     → B2、B5、B8の合計
=SUM(B:B)           → B列全体の合計
```

**使用例**: 売上の合計を求める
```
     A         B
1  商品名    売上
2  りんご    15,000
3  みかん    16,000
4  バナナ    10,000
5  合計      =SUM(B2:B4)  → 41,000
```

### AVERAGE - 平均を求める

数値の平均を計算します。

```
=AVERAGE(B2:B10)    → B2からB10の平均
```

### MAX / MIN - 最大値・最小値

```
=MAX(B2:B10)        → B2からB10の最大値
=MIN(B2:B10)        → B2からB10の最小値
```

### COUNT / COUNTA - 数を数える

```
=COUNT(B2:B10)      → 数値が入っているセルの数
=COUNTA(B2:B10)     → 何かデータが入っているセルの数（文字列含む）
=COUNTBLANK(B2:B10) → 空白セルの数
```

---

## 5. よく使う関数（集計編）

### ROUND - 四捨五入

```
=ROUND(A1, 0)       → 小数点以下を四捨五入（整数にする）
=ROUND(A1, 2)       → 小数点第3位を四捨五入（小数点2桁にする）
=ROUND(A1, -2)      → 十の位を四捨五入（百の位にする）

=ROUNDUP(A1, 0)     → 切り上げ
=ROUNDDOWN(A1, 0)   → 切り捨て
```

**使用例**: 消費税の計算
```
=ROUNDDOWN(B2 * 0.1, 0)   → 消費税（切り捨て）
```

### SUBTOTAL - 小計

フィルターで絞り込んだ結果だけを集計します（非表示の行を除外）。

```
=SUBTOTAL(9, B2:B100)    → フィルター後の合計（9 = SUM）
=SUBTOTAL(1, B2:B100)    → フィルター後の平均（1 = AVERAGE）
=SUBTOTAL(2, B2:B100)    → フィルター後の件数（2 = COUNT）
```

| 番号 | 関数 | 説明 |
|------|------|------|
| 1 | AVERAGE | 平均 |
| 2 | COUNT | 数値の個数 |
| 3 | COUNTA | データの個数 |
| 9 | SUM | 合計 |
| 4 | MAX | 最大値 |
| 5 | MIN | 最小値 |

---

## 6. よく使う関数（文字列編）

### LEFT / RIGHT / MID - 文字列の一部を取り出す

```
=LEFT(A1, 3)        → 左から3文字を取り出す
=RIGHT(A1, 4)       → 右から4文字を取り出す
=MID(A1, 2, 5)      → 2文字目から5文字を取り出す
```

**使用例**: 電話番号の市外局番を取り出す
```
A1 = "03-1234-5678"
=LEFT(A1, 2)  → "03"
```

### LEN - 文字数を数える

```
=LEN(A1)            → セルの文字数
```

### TRIM - 余分なスペースを削除

```
=TRIM(A1)           → 前後のスペースを削除し、間のスペースは1つにまとめる
```

### SUBSTITUTE - 文字列を置き換える

```
=SUBSTITUTE(A1, "旧", "新")   → 「旧」を「新」に置換
```

**使用例**: ハイフンを削除
```
A1 = "03-1234-5678"
=SUBSTITUTE(A1, "-", "")  → "0312345678"
```

### CONCATENATE / & - 文字列を結合する

```
=A1 & B1             → A1とB1を結合
=A1 & " " & B1       → A1とB1をスペースで結合
=CONCATENATE(A1, B1)  → 同じ意味
```

**使用例**: 姓と名を結合
```
A1 = "田中"、B1 = "太郎"
=A1 & " " & B1  → "田中 太郎"
```

### TEXT - 数値を指定の書式で文字列にする

```
=TEXT(A1, "0000")        → 4桁のゼロ埋め（例: 42 → "0042"）
=TEXT(A1, "#,##0")       → カンマ区切り（例: 1500 → "1,500"）
=TEXT(A1, "yyyy/mm/dd")  → 日付書式（例: "2026/01/15"）
```

---

## 7. よく使う関数（日付編）

### TODAY / NOW - 今日の日付・現在の日時

```
=TODAY()             → 今日の日付（例: 2026/01/31）
=NOW()               → 現在の日時（例: 2026/01/31 14:30）
```

### YEAR / MONTH / DAY - 日付から年・月・日を取り出す

```
=YEAR(A1)            → 年を取り出す（例: 2026）
=MONTH(A1)           → 月を取り出す（例: 1）
=DAY(A1)             → 日を取り出す（例: 31）
```

### DATE - 年月日から日付を作る

```
=DATE(2026, 4, 1)    → 2026/04/01
```

### DATEDIF - 2つの日付の差を求める

```
=DATEDIF(A1, B1, "Y")    → 年数
=DATEDIF(A1, B1, "M")    → 月数
=DATEDIF(A1, B1, "D")    → 日数
```

**使用例**: 入社からの勤続年数
```
=DATEDIF(A1, TODAY(), "Y")  → 入社日から今日までの年数
```

### EDATE / EOMONTH - 月の加算と月末日

```
=EDATE(A1, 3)        → A1の3ヶ月後の日付
=EDATE(A1, -1)       → A1の1ヶ月前の日付
=EOMONTH(A1, 0)      → A1の月の月末日
=EOMONTH(A1, 1)      → A1の翌月の月末日
```

### WEEKDAY - 曜日を求める

```
=WEEKDAY(A1)              → 曜日番号（1=日, 2=月, ..., 7=土）
=TEXT(A1, "aaa")           → 曜日名（月, 火, 水, ...）
=TEXT(A1, "aaaa")          → 曜日名（月曜日, 火曜日, ...）
```

---

## 8. よく使う関数（検索・参照編）

### VLOOKUP - 縦方向に検索する

表の左端の列をキーにして、同じ行の別の列の値を取得します。

```
=VLOOKUP(検索値, 検索範囲, 列番号, FALSE)
```

**使用例**: 商品コードから商品名を取得
```
商品マスタ（Sheet2）:
     A          B         C
1  コード    商品名      単価
2  A001     りんご       150
3  A002     みかん       80
4  A003     バナナ       200

売上データ（Sheet1）:
=VLOOKUP(A2, Sheet2!A:C, 2, FALSE)  → 商品名を取得
=VLOOKUP(A2, Sheet2!A:C, 3, FALSE)  → 単価を取得
```

> **重要**: 最後の引数は必ず `FALSE`（完全一致）にしてください。
> `TRUE` にすると近似値で検索されて思わぬ結果になります。

### XLOOKUP - より新しい検索関数（Excel 2021以降）

VLOOKUP より柔軟に検索できます。

```
=XLOOKUP(検索値, 検索範囲, 戻り値の範囲)
```

**使用例**:
```
=XLOOKUP(A2, Sheet2!A:A, Sheet2!B:B)  → 商品名を取得
```

### INDEX + MATCH - 柔軟な検索

VLOOKUP では対応できない「左方向への検索」や複雑な条件にも対応できます。

```
=INDEX(戻り値の範囲, MATCH(検索値, 検索範囲, 0))
```

**使用例**:
```
=INDEX(B:B, MATCH("りんご", C:C, 0))  → C列から「りんご」を探してB列の値を返す
```

---

## 9. よく使う関数（条件付き編）

### IF - 条件分岐

```
=IF(条件, 真の場合, 偽の場合)
```

**使用例**:
```
=IF(B2>=80, "合格", "不合格")      → 80以上なら「合格」
=IF(B2="", "未入力", B2)           → 空白なら「未入力」と表示
=IF(B2>=90, "A", IF(B2>=70, "B", "C"))  → 90以上はA、70以上はB、それ以外はC
```

### IFS - 複数条件の分岐（Excel 2019以降）

```
=IFS(B2>=90, "A", B2>=70, "B", B2>=50, "C", TRUE, "D")
```

### SUMIF / SUMIFS - 条件付き合計

```
=SUMIF(条件範囲, 条件, 合計範囲)
=SUMIFS(合計範囲, 条件範囲1, 条件1, 条件範囲2, 条件2)
```

**使用例**:
```
=SUMIF(A:A, "りんご", C:C)              → 「りんご」の売上合計
=SUMIFS(C:C, A:A, "りんご", B:B, "東京")  → 東京の「りんご」の売上合計
```

### COUNTIF / COUNTIFS - 条件付きカウント

```
=COUNTIF(A:A, "りんご")                  → 「りんご」の件数
=COUNTIF(B:B, ">=80")                    → 80以上の件数
=COUNTIFS(A:A, "りんご", B:B, "東京")    → 東京の「りんご」の件数
```

### AVERAGEIF / AVERAGEIFS - 条件付き平均

```
=AVERAGEIF(A:A, "りんご", C:C)           → 「りんご」の平均売上
```

---

## 10. 表示形式（セルの書式設定）

### 数値の書式

| 書式 | 入力例 | 表示結果 | 用途 |
|------|--------|---------|------|
| `#,##0` | 1500 | 1,500 | カンマ区切り |
| `#,##0.00` | 1500 | 1,500.00 | 小数点2桁 |
| `0000` | 42 | 0042 | ゼロ埋め |
| `0.0%` | 0.156 | 15.6% | パーセント |
| `¥#,##0` | 1500 | ¥1,500 | 通貨 |

### 日付の書式

| 書式 | 表示例 | 説明 |
|------|--------|------|
| `yyyy/mm/dd` | 2026/01/31 | 年4桁/月2桁/日2桁 |
| `yyyy年m月d日` | 2026年1月31日 | 日本語表記 |
| `m/d` | 1/31 | 月/日（短縮） |
| `aaa` | 土 | 曜日（短縮） |
| `aaaa` | 土曜日 | 曜日（正式） |
| `ggge年m月d日` | 令和8年1月31日 | 和暦 |

### 書式設定のショートカット

| 操作 | ショートカット |
|------|--------------|
| セルの書式設定を開く | Ctrl + 1 |
| 太字 | Ctrl + B |
| 斜体 | Ctrl + I |
| 下線 | Ctrl + U |
| 取り消し線 | Ctrl + 5 |
| 通貨の書式 | Ctrl + Shift + 4 |
| パーセントの書式 | Ctrl + Shift + 5 |
| 標準の書式に戻す | Ctrl + Shift + ~ |

---

## 11. 印刷のコツ

### 印刷前の確認

| 操作 | ショートカット | 説明 |
|------|--------------|------|
| 印刷プレビュー | Ctrl + P | 印刷イメージを確認 |
| 改ページプレビュー | 表示タブ → 改ページプレビュー | ページの区切りを確認・調整 |

### よく使う印刷設定

| 設定 | 場所 | 説明 |
|------|------|------|
| 用紙サイズ | ページレイアウト → サイズ | A4、A3 など |
| 印刷の向き | ページレイアウト → 印刷の向き | 縦 / 横 |
| 余白 | ページレイアウト → 余白 | 狭い / 標準 / 広い |
| 拡大縮小 | ページレイアウト → 拡大縮小 | 1ページに収める設定 |
| 印刷タイトル | ページレイアウト → 印刷タイトル | ヘッダー行を全ページに表示 |
| 印刷範囲 | ページレイアウト → 印刷範囲 | 印刷する範囲を指定 |

> **ヒント**: 大きな表を印刷するときは、「印刷タイトル」で見出し行を設定すると、
> 2ページ目以降にも見出しが表示されて見やすくなります。

---

## 12. エラー値の意味と対処法

Excel でセルに表示されるエラーの意味と対処方法です。

| エラー | 意味 | よくある原因 | 対処法 |
|--------|------|-------------|--------|
| `#VALUE!` | 値のエラー | 数値と文字列の計算 | 参照先のデータ型を確認 |
| `#REF!` | 参照エラー | 参照先が削除された | 数式の参照先を修正 |
| `#NAME?` | 名前エラー | 関数名のスペルミス | 関数名を正しく入力 |
| `#DIV/0!` | ゼロ除算 | 0で割り算 | IF文でゼロチェック |
| `#N/A` | 該当なし | VLOOKUPで見つからない | 検索値・範囲を確認 |
| `#NULL!` | 空白エラー | 範囲指定の間違い | コロン(:)やカンマ(,)を確認 |
| `#NUM!` | 数値エラー | 計算結果が大きすぎる | 数値の範囲を確認 |
| `######` | 列幅不足 | セルの幅が足りない | 列幅を広げる |

### エラーを非表示にする方法

```
=IFERROR(VLOOKUP(A1, B:C, 2, FALSE), "")
```
→ エラーが出たら空白を表示する（`IFERROR` で囲む）

---

## 13. Insight Performance Management 固有のコマンド

Insight Performance Management ならではの便利なコマンドです。

### シート読取（Ctrl + R）

Excel ファイルの内容をプログラムから読み取ります。

```
対応形式: .xlsx, .xls, .xlsm, .xlsb
読取対象: セルの値、数式、書式、コメント、画像
```

### シート書込（Ctrl + W）

データを Excel ファイルに書き込みます。

```
書込形式: .xlsx
書込対象: セルの値、数式、書式、グラフ
```

### 数式解析

シート内の数式を解析して、依存関係や計算フローを可視化します。

```
┌─────────────────────────────────────────┐
│  数式解析結果: Sheet1!D2                 │
│                                         │
│  =B2*C2                                 │
│                                         │
│  参照先:                                │
│    B2 (単価) = 150                      │
│    C2 (数量) = 100                      │
│                                         │
│  計算結果: 15,000                       │
│                                         │
│  この数式を参照しているセル:            │
│    D10 (=SUM(D2:D9))                    │
└─────────────────────────────────────────┘
```

### バッチ処理

フォルダ内の複数 Excel ファイルをまとめて処理します。

```
対応操作:
  - 全ファイルから特定シートのデータを抽出
  - 全ファイルの特定セルを一括更新
  - 全ファイルの数式を一括チェック
  - 複数ファイルを1つにまとめる
```

### テンプレート

テンプレート Excel をもとに、データを差し込んで新しいファイルを生成します。

```
使用例:
  テンプレート: 請求書テンプレート.xlsx
  データ: 顧客リスト.xlsx
  → 顧客ごとの請求書を自動生成
```

### 変更履歴（Ctrl + H）

Excel ファイルの変更履歴を表示・管理します。
詳しくは「[履歴ファイルについて](./HISTORY_FILES.md)」をご覧ください。

---

## 付録: 関数一覧（カテゴリ別）

### 数学・統計

| 関数 | 説明 | 例 |
|------|------|-----|
| SUM | 合計 | `=SUM(A1:A10)` |
| AVERAGE | 平均 | `=AVERAGE(A1:A10)` |
| MAX | 最大値 | `=MAX(A1:A10)` |
| MIN | 最小値 | `=MIN(A1:A10)` |
| COUNT | 数値の個数 | `=COUNT(A1:A10)` |
| COUNTA | データの個数 | `=COUNTA(A1:A10)` |
| COUNTBLANK | 空白の個数 | `=COUNTBLANK(A1:A10)` |
| ROUND | 四捨五入 | `=ROUND(A1, 2)` |
| ROUNDUP | 切り上げ | `=ROUNDUP(A1, 0)` |
| ROUNDDOWN | 切り捨て | `=ROUNDDOWN(A1, 0)` |
| INT | 整数部分 | `=INT(A1)` |
| MOD | 余り | `=MOD(A1, 3)` |
| ABS | 絶対値 | `=ABS(A1)` |
| SUBTOTAL | 小計 | `=SUBTOTAL(9, A1:A10)` |

### 文字列

| 関数 | 説明 | 例 |
|------|------|-----|
| LEFT | 左から取り出し | `=LEFT(A1, 3)` |
| RIGHT | 右から取り出し | `=RIGHT(A1, 4)` |
| MID | 途中から取り出し | `=MID(A1, 2, 5)` |
| LEN | 文字数 | `=LEN(A1)` |
| TRIM | スペース削除 | `=TRIM(A1)` |
| SUBSTITUTE | 置換 | `=SUBSTITUTE(A1, "旧", "新")` |
| CONCATENATE | 結合 | `=CONCATENATE(A1, B1)` |
| TEXT | 書式変換 | `=TEXT(A1, "#,##0")` |
| VALUE | 文字→数値 | `=VALUE(A1)` |
| UPPER | 大文字に | `=UPPER(A1)` |
| LOWER | 小文字に | `=LOWER(A1)` |
| FIND | 文字位置検索 | `=FIND("@", A1)` |

### 日付・時刻

| 関数 | 説明 | 例 |
|------|------|-----|
| TODAY | 今日の日付 | `=TODAY()` |
| NOW | 現在の日時 | `=NOW()` |
| YEAR | 年 | `=YEAR(A1)` |
| MONTH | 月 | `=MONTH(A1)` |
| DAY | 日 | `=DAY(A1)` |
| DATE | 日付作成 | `=DATE(2026, 4, 1)` |
| DATEDIF | 日付の差 | `=DATEDIF(A1, B1, "M")` |
| EDATE | 月の加算 | `=EDATE(A1, 3)` |
| EOMONTH | 月末日 | `=EOMONTH(A1, 0)` |
| WEEKDAY | 曜日番号 | `=WEEKDAY(A1)` |
| NETWORKDAYS | 営業日数 | `=NETWORKDAYS(A1, B1)` |

### 検索・参照

| 関数 | 説明 | 例 |
|------|------|-----|
| VLOOKUP | 縦方向検索 | `=VLOOKUP(A1, B:D, 2, FALSE)` |
| HLOOKUP | 横方向検索 | `=HLOOKUP(A1, 1:3, 2, FALSE)` |
| XLOOKUP | 新しい検索 | `=XLOOKUP(A1, B:B, C:C)` |
| INDEX | 位置指定取得 | `=INDEX(A:A, 5)` |
| MATCH | 位置検索 | `=MATCH("りんご", A:A, 0)` |
| INDIRECT | 文字→参照 | `=INDIRECT("A" & B1)` |
| ROW | 行番号 | `=ROW()` |
| COLUMN | 列番号 | `=COLUMN()` |

### 条件・論理

| 関数 | 説明 | 例 |
|------|------|-----|
| IF | 条件分岐 | `=IF(A1>80, "合格", "不合格")` |
| IFS | 複数条件分岐 | `=IFS(A1>=90, "A", A1>=70, "B")` |
| IFERROR | エラー処理 | `=IFERROR(A1/B1, 0)` |
| AND | かつ | `=AND(A1>0, A1<100)` |
| OR | または | `=OR(A1="A", A1="B")` |
| NOT | 否定 | `=NOT(A1="")` |
| SUMIF | 条件付き合計 | `=SUMIF(A:A, "りんご", B:B)` |
| SUMIFS | 複数条件合計 | `=SUMIFS(C:C, A:A, "りんご", B:B, "東京")` |
| COUNTIF | 条件付き件数 | `=COUNTIF(A:A, "りんご")` |
| COUNTIFS | 複数条件件数 | `=COUNTIFS(A:A, "りんご", B:B, "東京")` |
| AVERAGEIF | 条件付き平均 | `=AVERAGEIF(A:A, "りんご", B:B)` |
